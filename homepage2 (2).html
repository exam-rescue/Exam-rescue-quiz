<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Exam Rescue</title>
    <style>
        /* --- SCOPED HOME STYLES --- */
        :root {
            --h-primary: #4f46e5;
            --h-primary-dark: #4338ca;
            --h-bg: #f8fafc;
            --h-text: #0f172a;
            --h-text-sub: #64748b;
            --h-surface: #ffffff;
        }
        
        body { 
            margin: 0; padding: 0; 
            font-family: 'Inter', system-ui, -apple-system, sans-serif; 
            background: linear-gradient(135deg, #f8fafc 0%, #eff6ff 100%); 
            color: var(--h-text); 
            -webkit-tap-highlight-color: transparent; 
            min-height: 100vh;
        }
        
        #home-app { 
            max-width: 480px; 
            margin: 0 auto; 
            padding: 24px; 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column; 
            box-sizing: border-box;
        }
        
        .h-hidden { display: none !important; }
        
        /* Branding */
        .h-header { text-align: center; margin-bottom: 40px; margin-top: 20px; animation: h-fade-in 0.6s ease-out; }
        .h-logo { 
            width: 100px; height: 100px; 
            border-radius: 24px; 
            object-fit: cover; 
            margin-bottom: 20px; 
            box-shadow: 0 20px 40px -10px rgba(79, 70, 229, 0.2); 
            background: white;
        }
        .h-title { 
            font-size: 28px; 
            font-weight: 800; 
            letter-spacing: -0.03em; 
            margin-bottom: 10px; 
            color: var(--h-text); 
            line-height: 1.2;
        }
        .h-desc { 
            font-size: 15px; 
            color: var(--h-text-sub); 
            line-height: 1.6; 
            font-weight: 400; 
            padding: 0 10px; 
        }
        
        /* Mode Selection */
        .h-modes { display: grid; grid-template-columns: 1fr; gap: 20px; margin-bottom: 40px; animation: h-fade-up 0.8s ease-out; }
        .h-mode-card { 
            background: var(--h-surface); 
            padding: 24px; 
            border-radius: 24px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid rgba(255,255,255,0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            position: relative;
            overflow: hidden;
        }
        
        .h-mode-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(45deg, transparent 0%, rgba(79, 70, 229, 0.03) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .h-mode-card:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.01);
            border-color: rgba(79, 70, 229, 0.1);
        }
        .h-mode-card:hover::before { opacity: 1; }
        .h-mode-card:active { transform: scale(0.98); }
        
        .h-mode-info { display: flex; align-items: center; gap: 20px; position: relative; z-index: 1; }
        .h-mode-icon { 
            width: 56px; height: 56px; 
            display: flex; align-items: center; justify-content: center; 
            border-radius: 18px; 
            font-size: 24px;
            transition: transform 0.3s;
        }
        .h-mode-card:hover .h-mode-icon { transform: scale(1.1) rotate(5deg); }
        
        .h-icon-practice { background: #e0e7ff; color: #4338ca; }
        .h-icon-quiz { background: #fef3c7; color: #d97706; }
        
        .h-mode-text { text-align: left; }
        .h-mode-title { 
            font-weight: 700; 
            font-size: 17px; 
            color: var(--h-text); 
            display: block; 
            margin-bottom: 4px;
        }
        .h-mode-sub { font-size: 13px; color: var(--h-text-sub); font-weight: 500; }
        
        .h-arrow { 
            width: 32px; height: 32px; 
            display: flex; align-items: center; justify-content: center;
            color: #cbd5e1; 
            background: #f8fafc;
            border-radius: 50%;
            transition: all 0.3s;
        }
        .h-mode-card:hover .h-arrow { background: var(--h-primary); color: white; transform: translateX(5px); }

        /* Testimonials - Premium Carousel */
        .h-testimonials { 
            margin-bottom: 40px; 
            animation: h-fade-up 1s ease-out;
            position: relative;
        }
        .h-test-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            height: 360px; /* Fixed height for 3 cards */
            overflow: hidden;
            position: relative;
        }
        .h-test-container::after {
            content: '';
            position: absolute;
            bottom: 0; left: 0; right: 0;
            height: 60px;
            background: linear-gradient(to bottom, transparent, #f8fafc);
            pointer-events: none;
            z-index: 10;
        }
        .h-test-card { 
            background: white; 
            padding: 20px; 
            border-radius: 20px; 
            border: 1px solid rgba(241, 245, 249, 0.8); 
            margin-bottom: 0;
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.05);
            display: flex;
            gap: 15px;
            align-items: flex-start;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 1;
            transform: translateY(0);
        }
        .h-test-card.h-test-enter {
            opacity: 0;
            transform: translateY(20px);
        }
        .h-test-card.h-test-leave {
            opacity: 0;
            transform: translateY(-20px);
            margin-top: -110px; /* Collapse space */
        }

        .h-test-avatar {
            width: 48px; height: 48px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid white;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        .h-test-content { flex: 1; }
        .h-test-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 6px;
        }
        .h-test-author { 
            font-weight: 700; 
            color: #1e293b; 
            font-size: 14px; 
        }
        .h-test-stars { color: #f59e0b; font-size: 12px; letter-spacing: 1px; }
        .h-test-text {
            font-size: 13px; 
            color: #64748b; 
            line-height: 1.5;
            font-style: italic;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Social */
        .h-social { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: auto; animation: h-fade-in 1.2s ease-out; }
        .h-btn-social { 
            padding: 16px; 
            border-radius: 18px; 
            text-align: center; 
            font-weight: 600; 
            color: white; 
            text-decoration: none; 
            font-size: 14px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 10px; 
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .h-btn-social:active { transform: scale(0.96); }
        .h-tg { background: linear-gradient(135deg, #229ED9 0%, #1c88bd 100%); }
        .h-wa { background: linear-gradient(135deg, #25D366 0%, #20bd5a 100%); }
        
        .h-footer {
            text-align: center; margin-top: 30px; 
            color: #1f2937; font-size: 12px; font-weight: 600; 
            letter-spacing: 0.5px;
        }

        /* Animations */
        @keyframes h-fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes h-fade-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Loader - Modern Spinner */
        #h-loader { 
            position: fixed; inset: 0; background: #ffffff; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            z-index: 2000; transition: opacity 0.5s; 
            font-family: 'Inter', sans-serif;
        }
        .h-spinner-box {
            width: 60px; height: 60px;
            position: relative; margin-bottom: 20px;
        }
        .h-circle-border {
            width: 100%; height: 100%;
            border-radius: 50%;
            border: 4px solid #f3f4f6;
        }
        .h-circle-core {
            width: 100%; height: 100%;
            border-radius: 50%;
            border: 4px solid transparent;
            border-top-color: #4f46e5;
            position: absolute; top: 0; left: 0;
            animation: h-spin 1s linear infinite;
        }
        @keyframes h-spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .h-loader-text {
            font-weight: 600; color: #64748b; font-size: 15px;
            letter-spacing: -0.5px;
            animation: h-pulse-text 2s infinite ease-in-out;
        }
        @keyframes h-pulse-text {
            0%, 100% { opacity: 0.5; transform: scale(0.98); }
            50% { opacity: 1; transform: scale(1); }
        }
        
        /* Iframe Container */
        #app-frame-container { 
            position: fixed; inset: 0; width: 100%; height: 100%; 
            background: white; z-index: 9999; display: none;
            animation: h-slide-in 0.3s ease-out;
        }
        @keyframes h-slide-in { from { transform: translateX(100%); } to { transform: translateX(0); } }
        
        iframe { width: 100%; height: 100%; border: none; display: block; }
        
        .h-back-hint {
            position: fixed; top: 15px; right: 15px; 
            background: rgba(15, 23, 42, 0.8); color: white; 
            padding: 8px 16px; border-radius: 30px; 
            font-size: 12px; font-weight: 500;
            z-index: 10000; pointer-events: none;
            opacity: 0; transition: opacity 0.5s;
            backdrop-filter: blur(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

    <!-- Maintenance View -->
    <div id="maintenance-view" class="h-hidden" style="position:fixed; inset:0; background:white; z-index:5000; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:20px;">
        <div style="font-size:64px; margin-bottom:20px;">üöß</div>
        <h2 id="maint-title" style="font-size:24px; font-weight:800; color:#1e293b; margin-bottom:10px;">System Under Maintenance</h2>
        <p id="maint-desc" style="font-size:16px; color:#64748b; margin-bottom:30px; max-width:400px; line-height:1.5;">We are currently updating our content. Please check back later.</p>
        <div style="display:flex; gap:15px; width:100%; max-width:300px; flex-direction:column;">
             <a id="maint-wa" href="#" target="_blank" class="h-btn-social h-wa">Join WhatsApp Channel</a>
             <a id="maint-tg" href="#" target="_blank" class="h-btn-social h-tg">Join Telegram Channel</a>
             <button onclick="document.getElementById('maintenance-view').classList.add('h-hidden')" style="margin-top:10px; padding:12px; background:transparent; border:none; color:#64748b; font-weight:600; cursor:pointer;">Back to Home</button>
        </div>
    </div>

    <!-- Home Loader -->
    <div id="h-loader">
        <div class="h-spinner-box">
            <div class="h-circle-border"></div>
            <div class="h-circle-core"></div>
        </div>
        <div id="h-loading-text" class="h-loader-text">Loading Resources...</div>
    </div>

    <!-- Home View -->
    <div id="home-app">
        <div class="h-header">
            <img id="ui-logo" class="h-logo h-hidden" src="">
            <h1 id="ui-title" class="h-title">Exam Rescue</h1>
            <p id="ui-desc" class="h-desc">Welcome! Select a mode to begin your preparation journey.</p>
        </div>

        <div class="h-modes">
            <div class="h-mode-card" onclick="launchMode('practice')">
                <div class="h-mode-info">
                    <div class="h-mode-icon h-icon-practice">
                        <!-- Book Icon -->
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                    </div>
                    <div class="h-mode-text">
                        <span id="btn-practice-txt" class="h-mode-title">Practice Mode</span>
                        <span class="h-mode-sub">Chapter-wise learning</span>
                    </div>
                </div>
                <div class="h-arrow">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </div>
            </div>

            <div class="h-mode-card" onclick="launchMode('quiz')">
                <div class="h-mode-info">
                    <div class="h-mode-icon h-icon-quiz">
                        <!-- Lightning Icon -->
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
                    </div>
                    <div class="h-mode-text">
                        <span id="btn-quiz-txt" class="h-mode-title">Live Quiz</span>
                        <span class="h-mode-sub">Compete & Rank</span>
                    </div>
                </div>
                <div class="h-arrow">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </div>
            </div>
        </div>

        <div id="ui-testimonials" class="h-testimonials"></div>

        <div class="h-social">
            <a id="ui-tg" href="#" target="_blank" class="h-btn-social h-tg">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 2L11 13"></path><path d="M22 2l-7 20-4-9-9-4 20-7z"></path></svg>
                Telegram
            </a>
            <a id="ui-wa" href="#" target="_blank" class="h-btn-social h-wa">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                WhatsApp
            </a>
        </div>
        
        <div class="h-footer">
    Made with ‚ù§Ô∏è by Exam Rescue (India) <br>
    &copy; 2026 Exam Rescue. All rights reserved.
</div>


    <!-- Mode Container -->
    <div id="app-frame-container"></div>
    <div id="back-toast" class="h-back-hint">√¢‚Ä†¬ª Refresh to return Home</div>

    <!-- EMBEDDED DATA -->
    <script id="data-practice" type="text/plain">PG1ldGEgbmFtZT0ndmlld3BvcnQnIGNvbnRlbnQ9J3dpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xJy8+PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9bm8iPgogICAgPHRpdGxlPlByYWN0aWNlIE1vZGU8L3RpdGxlPgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vY2FudmFzLWNvbmZldHRpQDEuNi4wL2Rpc3QvY29uZmV0dGkuYnJvd3Nlci5taW4uanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pzcGRmLzIuNS4xL2pzcGRmLnVtZC5taW4uanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vcG9seWZpbGwuaW8vdjMvcG9seWZpbGwubWluLmpzP2ZlYXR1cmVzPWVzNiI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IGlkPSJNYXRoSmF4LXNjcmlwdCIgYXN5bmMgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL21hdGhqYXhAMy9lczUvdGV4LW1tbC1jaHRtbC5qcyI+PC9zY3JpcHQ+CiAgICAKICAgIDxzdHlsZT4KICAgICAgICA6cm9vdCB7CiAgICAgICAgICAgIC0tcHJpbWFyeTogIzI1NjNlYjsgLS1wcmltYXJ5LWRhcms6ICMxZTQwYWY7IC0tYWNjZW50OiAjZmY1YTVmOwogICAgICAgICAgICAtLWJnOiAjZjhmYWZjOyAtLWNhcmQ6ICNmZmZmZmY7IC0tdGV4dDogIzBmMTcyYTsgCiAgICAgICAgICAgIC0tc3VjY2VzczogIzEwYjk4MTsgLS1kYW5nZXI6ICNlZjQ0NDQ7IC0td2FybmluZzogI2Y1OWUwYjsKICAgICAgICAgICAgLS10ZzogIzAwODhjYzsgLS13YTogIzI1ZDM2NjsKICAgICAgICB9CiAgICAgICAgKiB7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7IG1hcmdpbjogMDsgcGFkZGluZzogMDsgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgIlNlZ29lIFVJIiwgUm9ib3RvLCBzYW5zLXNlcmlmOyAtd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50OyB9CiAgICAgICAgYm9keSB7IGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJnKTsgY29sb3I6IHZhcigtLXRleHQpOyBtaW4taGVpZ2h0OiAxMDB2aDsgZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjNzOyB9CiAgICAgICAgLmNvbnRhaW5lciB7IHdpZHRoOiAxMDAlOyBtYXgtd2lkdGg6IDUwMHB4OyBwYWRkaW5nOiAxNXB4OyBmbGV4OiAxOyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyB9CiAgICAgICAgCiAgICAgICAgLyogQ0FSRCBTVFlMRVMgKi8KICAgICAgICAuY2FyZCB7IGJhY2tncm91bmQ6IHZhcigtLWNhcmQpOyBib3JkZXItcmFkaXVzOiAyMHB4OyBwYWRkaW5nOiAyNHB4OyBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwwLDAsMC4wNSk7IG1hcmdpbi1ib3R0b206IDE1cHg7IHRleHQtYWxpZ246IGNlbnRlcjsgYm9yZGVyOiAxcHggc29saWQgI2YxZjVmOTsgcG9zaXRpb246IHJlbGF0aXZlOyBvdmVyZmxvdzogaGlkZGVuOyB9CiAgICAgICAgLmxvZ28geyB3aWR0aDogODBweDsgaGVpZ2h0OiA4MHB4OyBib3JkZXItcmFkaXVzOiAxOHB4OyBtYXJnaW4tYm90dG9tOiAxNXB4OyBvYmplY3QtZml0OiBjb3ZlcjsgfQogICAgICAgIGgxIHsgZm9udC1zaXplOiAyNHB4OyBmb250LXdlaWdodDogODAwOyBtYXJnaW4tYm90dG9tOiA4cHg7IGNvbG9yOiB2YXIoLS10ZXh0KTsgbGV0dGVyLXNwYWNpbmc6IC0wLjVweDsgfQogICAgICAgIAogICAgICAgIC8qIEZPUk0gRUxFTUVOVFMgKi8KICAgICAgICAuZm9ybS1ncm91cCB7IHRleHQtYWxpZ246IGxlZnQ7IG1hcmdpbi1ib3R0b206IDE1cHg7IH0KICAgICAgICBsYWJlbCB7IGRpc3BsYXk6IGJsb2NrOyBmb250LXNpemU6IDExcHg7IGZvbnQtd2VpZ2h0OiA4MDA7IGNvbG9yOiAjOTRhM2I4OyBtYXJnaW4tYm90dG9tOiA2cHg7IHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7IH0KICAgICAgICBzZWxlY3QsIGlucHV0IHsgd2lkdGg6IDEwMCU7IHBhZGRpbmc6IDE0cHg7IGJvcmRlcjogMnB4IHNvbGlkICNlMmU4ZjA7IGJvcmRlci1yYWRpdXM6IDE0cHg7IGZvbnQtc2l6ZTogMTVweDsgYmFja2dyb3VuZDogd2hpdGU7IG91dGxpbmU6IG5vbmU7IHRyYW5zaXRpb246IDAuMnM7IGZvbnQtd2VpZ2h0OiA2MDA7IH0KICAgICAgICBzZWxlY3Q6Zm9jdXMsIGlucHV0OmZvY3VzIHsgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5KTsgYm94LXNoYWRvdzogMCAwIDAgM3B4IHJnYmEoMzcsIDk5LCAyMzUsIDAuMSk7IH0KCiAgICAgICAgLyogQlVUVE9OUyAqLwogICAgICAgIC5idG4geyB3aWR0aDogMTAwJTsgcGFkZGluZzogMTZweDsgYm9yZGVyOiBub25lOyBib3JkZXItcmFkaXVzOiAxNnB4OyBmb250LXNpemU6IDE2cHg7IGZvbnQtd2VpZ2h0OiA3MDA7IGN1cnNvcjogcG9pbnRlcjsgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXMsIGJveC1zaGFkb3cgMC4yczsgbWFyZ2luLXRvcDogMTBweDsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGdhcDogOHB4OyB9CiAgICAgICAgLmJ0bjphY3RpdmUgeyB0cmFuc2Zvcm06IHNjYWxlKDAuOTgpOyB9CiAgICAgICAgLmJ0bi1wcmltYXJ5IHsgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeSk7IGNvbG9yOiB3aGl0ZTsgYm94LXNoYWRvdzogMCA0cHggNnB4IC0xcHggcmdiYSgzNywgOTksIDIzNSwgMC4yKTsgfQogICAgICAgIC5idG4tb3V0bGluZSB7IGJhY2tncm91bmQ6IHdoaXRlOyBib3JkZXI6IDJweCBzb2xpZCAjY2JkNWUxOyBjb2xvcjogIzQ3NTU2OTsgfQogICAgICAgIC5idG4tZGFuZ2VyIHsgYmFja2dyb3VuZDogdmFyKC0tZGFuZ2VyKTsgY29sb3I6IHdoaXRlOyB9CiAgICAgICAgLmJ0bi13aGF0c2FwcCB7IGJhY2tncm91bmQ6ICMyNWQzNjY7IGNvbG9yOiB3aGl0ZTsgdGV4dC1kZWNvcmF0aW9uOiBub25lOyB9CgogICAgICAgIC8qIFFVSVogVUkgKi8KICAgICAgICAucXVpei1oZWFkZXIgeyBkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7IG1hcmdpbi1ib3R0b206IDE1cHg7IH0KICAgICAgICAudGltZXItYmFkZ2UgeyBiYWNrZ3JvdW5kOiAjZmVlMmUyOyBjb2xvcjogI2VmNDQ0NDsgcGFkZGluZzogNnB4IDE0cHg7IGJvcmRlci1yYWRpdXM6IDMwcHg7IGZvbnQtc2l6ZTogMTNweDsgZm9udC13ZWlnaHQ6IDgwMDsgfQogICAgICAgIC5wcm9ncmVzcy10ZXh0IHsgZm9udC13ZWlnaHQ6IDgwMDsgZm9udC1zaXplOiAxM3B4OyBjb2xvcjogIzY0NzQ4YjsgfQogICAgICAgIC5xLXRleHQgeyBmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiA3MDA7IG1hcmdpbi1ib3R0b206IDIwcHg7IHRleHQtYWxpZ246IGxlZnQ7IGxpbmUtaGVpZ2h0OiAxLjY7IH0KCiAgICAgICAgLmFjdGlvbi1iYXIgeyBkaXNwbGF5OiBmbGV4OyBnYXA6IDEwcHg7IG1hcmdpbi10b3A6IDIwcHg7IGJvcmRlci10b3A6IDFweCBzb2xpZCAjZjFmNWY5OyBwYWRkaW5nLXRvcDogMTVweDsganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsgfQogICAgICAgIC5hY3Rpb24tYnRuIHsgYmFja2dyb3VuZDogI2Y4ZmFmYzsgYm9yZGVyOiAxcHggc29saWQgI2UyZThmMDsgcGFkZGluZzogMTBweCAxNnB4OyBib3JkZXItcmFkaXVzOiAxMHB4OyBmb250LXNpemU6IDEzcHg7IGZvbnQtd2VpZ2h0OiA3MDA7IGNvbG9yOiAjNjQ3NDhiOyBjdXJzb3I6IHBvaW50ZXI7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4OyB0cmFuc2l0aW9uOiAwLjJzOyB9CiAgICAgICAgLmFjdGlvbi1idG4uYWN0aXZlIHsgYmFja2dyb3VuZDogI2ZmZmJlYjsgYm9yZGVyLWNvbG9yOiAjZmJiZjI0OyBjb2xvcjogI2I0NTMwOTsgfQogICAgICAgIAogICAgICAgIC5vcHRpb24geyBiYWNrZ3JvdW5kOiB3aGl0ZTsgYm9yZGVyOiAycHggc29saWQgI2UyZThmMDsgcGFkZGluZzogMTZweDsgYm9yZGVyLXJhZGl1czogMTRweDsgdGV4dC1hbGlnbjogbGVmdDsgbWFyZ2luLWJvdHRvbTogMTJweDsgY3Vyc29yOiBwb2ludGVyOyBmb250LXdlaWdodDogNjAwOyBmb250LXNpemU6IDE1cHg7IHRyYW5zaXRpb246IDAuMnM7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OyBnYXA6IDEycHg7IH0KICAgICAgICAub3B0aW9uLWNpcmNsZSB7IG1pbi13aWR0aDogMjZweDsgaGVpZ2h0OiAyNnB4OyBib3JkZXItcmFkaXVzOiA1MCU7IGJvcmRlcjogMnB4IHNvbGlkICNjYmQ1ZTE7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBmb250LXNpemU6IDEzcHg7IGZvbnQtd2VpZ2h0OiA4MDA7IGNvbG9yOiAjOTRhM2I4OyBtYXJnaW4tdG9wOiAtMnB4OyB9CiAgICAgICAgLm9wdGlvbi5jb3JyZWN0IHsgYmFja2dyb3VuZDogI2RjZmNlNyAhaW1wb3J0YW50OyBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MpICFpbXBvcnRhbnQ7IGNvbG9yOiAjMTU4MDNkICFpbXBvcnRhbnQ7IH0KICAgICAgICAub3B0aW9uLmNvcnJlY3QgLm9wdGlvbi1jaXJjbGUgeyBiYWNrZ3JvdW5kOiB2YXIoLS1zdWNjZXNzKTsgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzKTsgY29sb3I6IHdoaXRlOyB9CiAgICAgICAgLm9wdGlvbi53cm9uZyB7IGJhY2tncm91bmQ6ICNmZWUyZTIgIWltcG9ydGFudDsgYm9yZGVyLWNvbG9yOiB2YXIoLS1kYW5nZXIpICFpbXBvcnRhbnQ7IGNvbG9yOiAjOTkxYjFiICFpbXBvcnRhbnQ7IH0KICAgICAgICAub3B0aW9uLndyb25nIC5vcHRpb24tY2lyY2xlIHsgYmFja2dyb3VuZDogdmFyKC0tZGFuZ2VyKTsgYm9yZGVyLWNvbG9yOiB2YXIoLS1kYW5nZXIpOyBjb2xvcjogd2hpdGU7IH0KCiAgICAgICAgLmV4cGxhbmF0aW9uIHsgYmFja2dyb3VuZDogI2VmZjZmZjsgcGFkZGluZzogMTZweDsgYm9yZGVyLXJhZGl1czogMTRweDsgdGV4dC1hbGlnbjogbGVmdDsgZm9udC1zaXplOiAxNHB4OyBjb2xvcjogIzFlNDBhZjsgYm9yZGVyLWxlZnQ6IDVweCBzb2xpZCB2YXIoLS1wcmltYXJ5KTsgbWFyZ2luLXRvcDogMTVweDsgZGlzcGxheTogbm9uZTsgfQoKICAgICAgICAuc3ViamVjdC1ncmlkIHsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7IGdhcDogMTBweDsgbWFyZ2luLXRvcDogNXB4OyB9CiAgICAgICAgLnN1YmplY3QtYnRuIHsgYmFja2dyb3VuZDogd2hpdGU7IGJvcmRlcjogMnB4IHNvbGlkICNlMmU4ZjA7IHBhZGRpbmc6IDE1cHg7IGJvcmRlci1yYWRpdXM6IDEycHg7IGZvbnQtd2VpZ2h0OiA3MDA7IGNvbG9yOiB2YXIoLS10ZXh0KTsgY3Vyc29yOiBwb2ludGVyOyB0ZXh0LWFsaWduOiBsZWZ0OyBkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7IHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4yczsgfQogICAgICAgIC5zdWJqZWN0LWJ0bi5oYXMtc2VsZWN0aW9uIHsgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5KTsgYmFja2dyb3VuZDogI2VmZjZmZjsgY29sb3I6IHZhcigtLXByaW1hcnkpOyB9CiAgICAgICAgLnN1YmplY3QtYnRuLmhhcy1zZWxlY3Rpb246OmFmdGVyIHsgY29udGVudDogJ+KclCc7IH0KCiAgICAgICAgLyogTU9EQUxTICovCiAgICAgICAgLm1vZGFsLW92ZXJsYXkgeyBwb3NpdGlvbjogZml4ZWQ7IGluc2V0OiAwOyBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuNik7IHotaW5kZXg6IDIwMDA7IGRpc3BsYXk6IG5vbmU7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNXB4KTsgfQogICAgICAgIC5tb2RhbC1jb250ZW50IHsgYmFja2dyb3VuZDogd2hpdGU7IHdpZHRoOiA5MCU7IG1heC13aWR0aDogNDAwcHg7IGJvcmRlci1yYWRpdXM6IDIwcHg7IHBhZGRpbmc6IDI0cHg7IG1heC1oZWlnaHQ6IDg1dmg7IGRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGFuaW1hdGlvbjogcG9wVXAgMC4zcyBjdWJpYy1iZXppZXIoMC4xOCwgMC44OSwgMC4zMiwgMS4yOCk7IH0KICAgICAgICBAa2V5ZnJhbWVzIHBvcFVwIHsgZnJvbSB7IHRyYW5zZm9ybTogc2NhbGUoMC44KTsgb3BhY2l0eTogMDsgfSB0byB7IHRyYW5zZm9ybTogc2NhbGUoMSk7IG9wYWNpdHk6IDE7IH0gfQogICAgICAgIAogICAgICAgIC5jaGFwdGVyLWdyaWQgeyBvdmVyZmxvdy15OiBhdXRvOyBkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnI7IGdhcDogOHB4OyBwYWRkaW5nLWJvdHRvbTogMTBweDsgfQogICAgICAgIC5jaGFwdGVyLWNoaXAgaW5wdXQgeyBwb3NpdGlvbjogYWJzb2x1dGU7IG9wYWNpdHk6IDA7IH0KICAgICAgICAuY2hhcHRlci1jaGlwIGxhYmVsIHsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IHRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMTJweCA1cHg7IGJhY2tncm91bmQ6ICNmOGZhZmM7IGJvcmRlcjogMnB4IHNvbGlkICNlMmU4ZjA7IGJvcmRlci1yYWRpdXM6IDEwcHg7IGZvbnQtc2l6ZTogMTJweDsgZm9udC13ZWlnaHQ6IDYwMDsgY29sb3I6ICM0NzU1Njk7IGN1cnNvcjogcG9pbnRlcjsgd2lkdGg6IDEwMCU7IG1pbi1oZWlnaHQ6IDUwcHg7IGxpbmUtaGVpZ2h0OiAxLjM7IHRyYW5zaXRpb246IDAuMnM7IH0KICAgICAgICAuY2hhcHRlci1jaGlwIGlucHV0OmNoZWNrZWQgKyBsYWJlbCB7IGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnkpOyBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnkpOyBjb2xvcjogd2hpdGU7IH0KCiAgICAgICAgLyogVVRJTFMgKi8KICAgICAgICAuaGlkZGVuIHsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmxvYWRlciB7IHBvc2l0aW9uOiBmaXhlZDsgaW5zZXQ6IDA7IGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC45NSk7IGRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOyB6LWluZGV4OiA5OTsgfQogICAgICAgIC5zcGlubmVyIHsgd2lkdGg6IDQwcHg7IGhlaWdodDogNDBweDsgYm9yZGVyOiA0cHggc29saWQgI2UyZThmMDsgYm9yZGVyLXRvcDogNHB4IHNvbGlkIHZhcigtLXByaW1hcnkpOyBib3JkZXItcmFkaXVzOiA1MCU7IGFuaW1hdGlvbjogc3BpbiAwLjhzIGxpbmVhciBpbmZpbml0ZTsgfQogICAgICAgIEBrZXlmcmFtZXMgc3BpbiB7IHRvIHsgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsgfSB9CiAgICAgICAgCiAgICAgICAgLyogUkVTVUxUICYgUFJPTU8gKi8KICAgICAgICAucmVzdWx0LXN0YXRzIHsgZGlzcGxheTpncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnI7IGdhcDoxMHB4OyBtYXJnaW46MjBweCAwOyB9CiAgICAgICAgLnN0YXQtYm94IHsgYmFja2dyb3VuZDojZjhmYWZjOyBib3JkZXI6MXB4IHNvbGlkICNlMmU4ZjA7IHBhZGRpbmc6MTVweDsgYm9yZGVyLXJhZGl1czoxNHB4OyB9CiAgICAgICAgLnN0YXQtdmFsIHsgZm9udC1zaXplOjIwcHg7IGZvbnQtd2VpZ2h0OjkwMDsgY29sb3I6dmFyKC0tdGV4dCk7IH0KICAgICAgICAuc3RhdC1sYWJlbCB7IGZvbnQtc2l6ZToxMnB4OyBmb250LXdlaWdodDo2MDA7IGNvbG9yOiM2NDc0OGI7IHRleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTsgfQogICAgICAgIAogICAgICAgIC5jaGFubmVsLXByb21vIHsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2YwZjlmZiAwJSwgI2UwZjJmZSAxMDAlKTsgYm9yZGVyOiAycHggc29saWQgI2JhZTZmZDsgYm9yZGVyLXJhZGl1czogMTZweDsgcGFkZGluZzogMjBweDsgbWFyZ2luLXRvcDogMjBweDsgdGV4dC1hbGlnbjogbGVmdDsgfQogICAgICAgIC5zb2NpYWwtYnRuIHsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IHBhZGRpbmc6IDE0cHg7IGJvcmRlci1yYWRpdXM6IDEycHg7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgZm9udC13ZWlnaHQ6IDgwMDsgY29sb3I6IHdoaXRlOyBmb250LXNpemU6IDE0cHg7IG1hcmdpbi10b3A6IDEwcHg7IGdhcDo4cHg7IH0KICAgICAgICAucHVsc2UgeyBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlOyB9CiAgICAgICAgQGtleWZyYW1lcyBwdWxzZSB7IDAlIHsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfSA1MCUgeyB0cmFuc2Zvcm06IHNjYWxlKDEuMDIpOyB9IDEwMCUgeyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9IH0KICAgICAgICAjcmVzdW1lLWJhciB7IGJhY2tncm91bmQ6ICNmZmY3ZWQ7IGJvcmRlcjogMXB4IHNvbGlkICNmZWQ3YWE7IHBhZGRpbmc6IDEycHg7IG1hcmdpbi1ib3R0b206IDE1cHg7IGJvcmRlci1yYWRpdXM6IDEycHg7IGRpc3BsYXk6IG5vbmU7IHRleHQtYWxpZ246IGNlbnRlcjsgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KCiAgICA8ZGl2IGlkPSJnbG9iYWwtbG9hZGVyIiBjbGFzcz0ibG9hZGVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzcGlubmVyIj48L2Rpdj4KICAgICAgICA8cCBzdHlsZT0ibWFyZ2luLXRvcDoyMHB4OyBmb250LXdlaWdodDo4MDA7IGNvbG9yOnZhcigtLXRleHQpOyIgaWQ9ImxvYWRlci10ZXh0Ij5Mb2FkaW5nIENvbmZpZy4uLjwvcD4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9ImNoYXB0ZXItbW9kYWwiIGNsYXNzPSJtb2RhbC1vdmVybGF5Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icXVpei1oZWFkZXIiIHN0eWxlPSJib3JkZXItYm90dG9tOiAxcHggc29saWQgI2YxZjVmOTsgcGFkZGluZy1ib3R0b206IDEwcHg7Ij4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtb2RhbC10aXRsZSIgaWQ9Im1vZGFsLXN1YmplY3QtdGl0bGUiIHN0eWxlPSJmb250LXdlaWdodDo4MDA7IGZvbnQtc2l6ZToxOHB4OyI+U3ViamVjdDwvc3Bhbj4KICAgICAgICAgICAgICAgIDxidXR0b24gc3R5bGU9ImJhY2tncm91bmQ6bm9uZTsgYm9yZGVyOm5vbmU7IGZvbnQtc2l6ZToyNHB4OyBjb2xvcjojNjQ3NDhiOyBjdXJzb3I6cG9pbnRlcjsiIG9uY2xpY2s9ImNsb3NlTW9kYWwoJ2NoYXB0ZXItbW9kYWwnKSI+4pyVPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJtb2RhbC1jaGFwdGVyLWdyaWQiIGNsYXNzPSJjaGFwdGVyLWdyaWQiPjwvZGl2PgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIG9uY2xpY2s9ImNsb3NlTW9kYWwoJ2NoYXB0ZXItbW9kYWwnKSI+RG9uZSBTZWxlY3Rpb248L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9ImFkbWluLW1zZy1vdmVybGF5IiBjbGFzcz0ibW9kYWwtb3ZlcmxheSI+CiAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi1ib3R0b206IDE1cHg7Ij4KICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQpOyBjb2xvcjogd2hpdGU7IHBhZGRpbmc6IDRweCAxMnB4OyBib3JkZXItcmFkaXVzOiAyMHB4OyBmb250LXNpemU6IDEycHg7IGZvbnQtd2VpZ2h0OiA4MDA7Ij5BRE1JTiBNRVNTQUdFPC9zcGFuPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBpZD0iYWRtaW4tbXNnLXRleHQiIHN0eWxlPSJjb2xvcjogdmFyKC0tdGV4dCk7IGZvbnQtc2l6ZTogMTVweDsgbGluZS1oZWlnaHQ6IDEuNjsgbWFyZ2luLWJvdHRvbToyMHB4OyI+PC9kaXY+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgb25jbGljaz0iY2xvc2VBZG1pbk1zZygpIj5Pa2F5LCBHb3QgaXQ8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CiAgICAgICAgCiAgICAgICAgPGRpdiBpZD0idmlldy1zZXR1cCIgY2xhc3M9ImNhcmQiPgogICAgICAgICAgICA8aW1nIGlkPSJhcHAtbG9nbyIgc3JjPSIiIGNsYXNzPSJsb2dvIGhpZGRlbiI+CiAgICAgICAgICAgIDxoMSBpZD0iYXBwLXRpdGxlIj5QcmFjdGljZSBNb2RlPC9oMT4KICAgICAgICAgICAgPHAgaWQ9ImFwcC1zdWJ0aXRsZSIgc3R5bGU9ImNvbG9yOiM2NDc0OGI7IGZvbnQtc2l6ZToxNHB4OyBmb250LXdlaWdodDo2MDA7IG1hcmdpbi1ib3R0b206MjBweDsiPkNvbmZpZ3VyZSB5b3VyIHNlc3Npb248L3A+CiAgICAgICAgICAgIAogICAgICAgICAgICA8ZGl2IGlkPSJyZXN1bWUtYmFyIj4KICAgICAgICAgICAgICAgIDxwIHN0eWxlPSJmb250LXNpemU6MTNweDsgZm9udC13ZWlnaHQ6NzAwOyBjb2xvcjojYzI0MTBjOyI+4pqg77iPIEluY29tcGxldGUgU2Vzc2lvbiBGb3VuZDwvcD4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDsgZ2FwOjEwcHg7IG1hcmdpbi10b3A6OHB4OyI+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBzdHlsZT0icGFkZGluZzoxMHB4OyBtYXJnaW46MDsgYmFja2dyb3VuZDojZmZmOyBib3JkZXI6MXB4IHNvbGlkICNmZWQ3YWE7IGNvbG9yOiNjMjQxMGM7IiBvbmNsaWNrPSJjbGVhclNlc3Npb24oKSI+Q2xlYXI8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIHN0eWxlPSJwYWRkaW5nOjEwcHg7IG1hcmdpbjowOyBiYWNrZ3JvdW5kOiNjMjQxMGM7IGNvbG9yOndoaXRlOyIgb25jbGljaz0icmVzdW1lU2Vzc2lvbigpIj5SZXN1bWU8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgICAgICAgICAgPGxhYmVsPllvdXIgTmFtZTwvbGFiZWw+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImlucC1uYW1lIiBwbGFjZWhvbGRlcj0iRW50ZXIgTmFtZSI+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICAgICAgICA8bGFiZWw+VGFyZ2V0IENsYXNzPC9sYWJlbD4KICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9InNlbC1jbGFzcyIgb25jaGFuZ2U9InVwZGF0ZVN0cmVhbXMoKSI+CiAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgQ2xhc3M8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMCI+Q2xhc3MgMTA8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMSI+Q2xhc3MgMTE8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMiI+Q2xhc3MgMTI8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJORUVUIj5ORUVUIERyb3BwZXIvRnVsbDwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IkpFRSI+SkVFIERyb3BwZXIvRnVsbDwvb3B0aW9uPgogICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICAgICAgICA8bGFiZWw+U3RyZWFtPC9sYWJlbD4KICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9InNlbC1zdHJlYW0iIG9uY2hhbmdlPSJyZW5kZXJTdWJqZWN0QnV0dG9ucygpIiBkaXNhYmxlZD4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPldhaXRpbmcgZm9yIENsYXNzLi4uPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgICAgIDxsYWJlbD5NZWRpdW08L2xhYmVsPgogICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0ic2VsLW1lZGl1bSIgb25jaGFuZ2U9InJlbmRlclN1YmplY3RCdXR0b25zKCkiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IkVuZ2xpc2giPkVuZ2xpc2g8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJIaW5kaSI+SGluZGk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgICAgICAgICAgPGxhYmVsPlNlbGVjdCBTdWJqZWN0czwvbGFiZWw+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJzdWJqZWN0LWNvbnRhaW5lciIgY2xhc3M9InN1YmplY3QtZ3JpZCI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0icGFkZGluZzoyMHB4OyB0ZXh0LWFsaWduOmNlbnRlcjsgYmFja2dyb3VuZDojZjhmYWZjOyBib3JkZXI6MnB4IGRhc2hlZCAjY2JkNWUxOyBib3JkZXItcmFkaXVzOjEycHg7IGNvbG9yOiM5NGEzYjg7IGZvbnQtc2l6ZToxM3B4OyBmb250LXdlaWdodDo2MDA7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgU2VsZWN0IENsYXNzICYgU3RyZWFtIHRvIHZpZXcgc3ViamVjdHMKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxidXR0b24gaWQ9ImJ0bi1zdGFydC1wcmFjdGljZSIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgb25jbGljaz0ic3RhcnRQcmFjdGljZSgpIj5TdGFydCBQcmFjdGljZSDwn5qAPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tb3V0bGluZSIgb25jbGljaz0id2luZG93LnBhcmVudC5jbG9zZUFwcCgpIj5CYWNrIHRvIEhvbWU8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBpZD0idmlldy1xdWl6IiBjbGFzcz0iaGlkZGVuIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icXVpei1oZWFkZXIiPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRpbWVyLWJhZGdlIiBpZD0idGltZXItZGlzcGxheSI+MDA6MDA8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0icHJvZ3Jlc3MtdGV4dCIgaWQ9InByb2dyZXNzLWRpc3BsYXkiPjEvNTA8L3NwYW4+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCIgc3R5bGU9InRleHQtYWxpZ246bGVmdDsiPgogICAgICAgICAgICAgICAgPGRpdiBpZD0icS1jb250ZW50IiBjbGFzcz0icS10ZXh0Ij5Mb2FkaW5nLi4uPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJvcHRpb25zLWNvbnRhaW5lciI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJleHBsYW5hdGlvbi1ib3giIGNsYXNzPSJleHBsYW5hdGlvbiI+PC9kaXY+CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImFjdGlvbi1iYXIiPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImFjdGlvbi1idG4iIGlkPSJidG4tYm9va21hcmsiIG9uY2xpY2s9InRvZ2dsZUJvb2ttYXJrKCkiPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjE4cHg7Ij7imIU8L3NwYW4+IFNhdmUKICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJhY3Rpb24tYnRuIiBpZD0iYnRuLXJlcG9ydCIgb25jbGljaz0icmVwb3J0RXJyb3IoKSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MThweDsiPvCfmqk8L3NwYW4+IFJlcG9ydAogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnI7IGdhcDoxMHB4OyI+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUiIHN0eWxlPSJtYXJnaW46MDsiIG9uY2xpY2s9InByZXZRdWVzdGlvbigpIiBpZD0iYnRuLXByZXYiIGRpc2FibGVkPlByZXZpb3VzPC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIHN0eWxlPSJtYXJnaW46MDsiIG9uY2xpY2s9Im5leHRRdWVzdGlvbigpIiBpZD0iYnRuLW5leHQiPk5leHQ8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tZGFuZ2VyIiBzdHlsZT0ibWFyZ2luLXRvcDoxNXB4OyIgb25jbGljaz0iZmluaXNoUHJhY3RpY2UoKSI+RmluaXNoIFNlc3Npb248L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBpZD0idmlldy1yZXN1bHQiIGNsYXNzPSJjYXJkIGhpZGRlbiI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi1ib3R0b206MTBweDsgZm9udC1zaXplOjQwcHg7Ij7wn4+GPC9kaXY+CiAgICAgICAgICAgIDxoMiBzdHlsZT0iZm9udC13ZWlnaHQ6ODAwOyBjb2xvcjp2YXIoLS10ZXh0KTsgbWFyZ2luLWJvdHRvbTo1cHg7Ij5TZXNzaW9uIENvbXBsZXRlITwvaDI+CiAgICAgICAgICAgIAogICAgICAgICAgICA8cCBpZD0icmVzLW1zZyIgc3R5bGU9ImNvbG9yOiM2NDc0OGI7IGZvbnQtd2VpZ2h0OjYwMDsgZm9udC1zaXplOjE0cHg7IG1hcmdpbi1ib3R0b206MjBweDsiPkdyZWF0IGVmZm9ydCE8L3A+CiAgICAgICAgICAgIAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZXN1bHQtc3RhdHMiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1ib3giPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtdmFsIiBzdHlsZT0iY29sb3I6dmFyKC0tcHJpbWFyeSk7IiBpZD0icmVzLXNjb3JlIj4wLzA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LWxhYmVsIj5TY29yZTwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LWJveCI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC12YWwiIHN0eWxlPSJjb2xvcjp2YXIoLS1zdWNjZXNzKTsiIGlkPSJyZXMtYWNjdXJhY3kiPjAlPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1sYWJlbCI+QWNjdXJhY3k8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1ib3giPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtdmFsIiBzdHlsZT0iY29sb3I6I2Y1OWUwYjsiIGlkPSJyZXMtdGltZSI+MG08L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LWxhYmVsIj5UaW1lPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtYm94Ij4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LXZhbCIgc3R5bGU9ImNvbG9yOnZhcigtLWRhbmdlcik7IiBpZD0icmVzLXdyb25nIj4wPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1sYWJlbCI+TWlzdGFrZXM8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxhIGlkPSJidG4tc2hhcmUtd2EiIGhyZWY9IiMiIHRhcmdldD0iX2JsYW5rIiBjbGFzcz0iYnRuIGJ0bi13aGF0c2FwcCIgc3R5bGU9Im1hcmdpbi10b3A6MDsiPgogICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxOHB4OyI+8J+TsTwvc3Bhbj4gU2hhcmUgU2NvcmUgb24gV2hhdHNBcHAKICAgICAgICAgICAgPC9hPgoKICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4OyBib3JkZXItY29sb3I6IzI1NjNlYjsgY29sb3I6IzI1NjNlYjsiIG9uY2xpY2s9ImRvd25sb2FkUERGKCkiPgogICAgICAgICAgICAgICAg8J+ThCBEb3dubG9hZCBQcmVtaXVtIFJlcG9ydAogICAgICAgICAgICA8L2J1dHRvbj4KCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNoYW5uZWwtcHJvbW8iPgogICAgICAgICAgICAgICAgPGgzIHN0eWxlPSJmb250LXNpemU6MTZweDsgZm9udC13ZWlnaHQ6ODAwOyBjb2xvcjojMDI4NGM3OyBtYXJnaW4tYm90dG9tOjEwcHg7Ij7wn46vIEpvaW4gT2ZmaWNpYWwgQ2hhbm5lbHM8L2gzPgogICAgICAgICAgICAgICAgPHVsIHN0eWxlPSJsaXN0LXN0eWxlOm5vbmU7IGZvbnQtc2l6ZToxM3B4OyBmb250LXdlaWdodDo2MDA7IGNvbG9yOiMzMzQxNTU7IGxpbmUtaGVpZ2h0OjEuNjsgbWFyZ2luLWJvdHRvbToxNXB4OyI+CiAgICAgICAgICAgICAgICAgICAgPGxpPuKchSBEYWlseSBDb25jZXB0IEJvb3N0ZXJzPC9saT4KICAgICAgICAgICAgICAgICAgICA8bGk+4pyFIEhpZ2gtWWllbGQgUFlRczwvbGk+CiAgICAgICAgICAgICAgICAgICAgPGxpPuKchSBGcmVlIE1vY2sgVGVzdHM8L2xpPgogICAgICAgICAgICAgICAgPC91bD4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6Z3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgMWZyOyBnYXA6MTBweDsiPgogICAgICAgICAgICAgICAgICAgIDxhIGlkPSJsaW5rLXRnIiBocmVmPSIjIiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9InNvY2lhbC1idG4iIHN0eWxlPSJiYWNrZ3JvdW5kOnZhcigtLXRnKTsgbWFyZ2luOjA7Ij5UZWxlZ3JhbTwvYT4KICAgICAgICAgICAgICAgICAgICA8YSBpZD0ibGluay13YSIgaHJlZj0iIyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJzb2NpYWwtYnRuIiBzdHlsZT0iYmFja2dyb3VuZDp2YXIoLS13YSk7IG1hcmdpbjowOyI+V2hhdHNBcHA8L2E+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4OyIgb25jbGljaz0id2luZG93LnBhcmVudC5jbG9zZUFwcCgpIj5CYWNrIHRvIEhvbWU8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBpZD0idmlldy1tYWludCIgY2xhc3M9ImNhcmQgaGlkZGVuIG1haW50LWJveCI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo1MHB4OyBtYXJnaW4tYm90dG9tOjE1cHg7Ij7wn5qnPC9kaXY+CiAgICAgICAgICAgIDxoMiBpZD0ibWFpbnQtdGl0bGUiPlN5c3RlbSBQYXVzZWQ8L2gyPgogICAgICAgICAgICA8cCBpZD0ibWFpbnQtbXNnIiBzdHlsZT0iZm9udC13ZWlnaHQ6NjAwOyBjb2xvcjojNjQ3NDhiOyI+VXBkYXRpbmcuLi48L3A+CiAgICAgICAgICAgIDxhIGlkPSJtYWludC10ZyIgaHJlZj0iIyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJzb2NpYWwtYnRuIiBzdHlsZT0iYmFja2dyb3VuZDp2YXIoLS10Zyk7Ij5DaGVjayBVcGRhdGVzPC9hPgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+Cgo8c2NyaXB0PgogICAgLy8gUkVQTEFDRSBXSVRIIFlPVVIgREVQTE9ZRUQgV0VCIEFQUCBVUkwKICAgIGNvbnN0IEFQSV9VUkwgPSAiaHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J4aDA5U29WNHVRZGJIZVZwbjhjYlUxbkpwdWc4dEtXbHNhbHU5UWFmQjZLVkNyQ1VCd2g3blZ5TmROTjZLbk5ndFBPZy9leGVjIjsKICAgIAogICAgLy8gREVGQVVMVCBMSU5LUyAoQ29uZmlnIGNhbiBvdmVycmlkZSB0aGVzZSBpZiBzZXQgaW4gc2hlZXQpCiAgICBjb25zdCBERUZBVUxUX1dBX0NIQU5ORUwgPSAiaHR0cHM6Ly93aGF0c2FwcC5jb20vY2hhbm5lbC8wMDI5VmI3T1pVdjFIc3B0TkdzUEFTMnIiOwogICAgY29uc3QgR0lUSFVCX1NIQVJFX1VSTCA9ICJodHRwczovL2V4YW0tcmVzY3VlLmdpdGh1Yi5pby9FeGFtLXJlc2N1ZS1xdWl6LyI7CgogICAgLy8gU1RBVEUKICAgIGxldCBhcHBDb25maWcgPSB7fTsKICAgIGxldCB0b3BpY0RhdGEgPSB7fTsKICAgIGxldCBxdWVzdGlvbnMgPSBbXTsKICAgIGxldCBjdXJyZW50SW5kZXggPSAwOwogICAgbGV0IHVzZXJBbnN3ZXJzID0ge307IAogICAgbGV0IGJvb2ttYXJrZWRRcyA9IG5ldyBTZXQoKTsKICAgIGxldCB0aW1lclN0YXJ0ID0gMDsKICAgIGxldCB0aW1lckludGVydmFsID0gbnVsbDsKICAgIGxldCBzZWxlY3RlZENoYXB0ZXJzID0gbmV3IFNldCgpOyAKICAgIGxldCBlbGFwc2VkVGltZSA9IDA7IAoKICAgIHdpbmRvdy5vbmxvYWQgPSBpbml0QXBwOwoKICAgIGFzeW5jIGZ1bmN0aW9uIGluaXRBcHAoKSB7CiAgICAgICAgY2hlY2tSZXN1bWUoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaEFQSSh7IGFjdGlvbjogJ2dldEluaXQnIH0pOwogICAgICAgICAgICBpZihyZXMuc3RhdHVzID09PSAnZXJyb3InKSB7IHNob3dNYWludGVuYW5jZShyZXMpOyByZXR1cm47IH0KICAgICAgICAgICAgYXBwQ29uZmlnID0gcmVzLmNvbmZpZyB8fCB7fTsKICAgICAgICAgICAgdG9waWNEYXRhID0gcmVzLnRvcGljcyB8fCB7fTsKICAgICAgICAgICAgYXBwbHlDb25maWcoKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dsb2JhbC1sb2FkZXInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIH0gY2F0Y2ggKGUpIHsgCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkZXItdGV4dCcpLmlubmVyVGV4dCA9ICJDb25uZWN0aW9uIEZhaWxlZC4gUGxlYXNlIFJlZnJlc2guIjsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRlci10ZXh0Jykuc3R5bGUuY29sb3IgPSAiI2VmNDQ0NCI7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGFwcGx5Q29uZmlnKCkgewogICAgICAgIGlmKGFwcENvbmZpZy5IZXJvX1RpdGxlKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwLXRpdGxlJykuaW5uZXJUZXh0ID0gYXBwQ29uZmlnLkhlcm9fVGl0bGU7CiAgICAgICAgaWYoYXBwQ29uZmlnLkJ1dHRvbl9UZXh0KSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXN0YXJ0LXByYWN0aWNlJykuaW5uZXJUZXh0ID0gYXBwQ29uZmlnLkJ1dHRvbl9UZXh0OwogICAgICAgIGlmKGFwcENvbmZpZy5BcHBfVGl0bGUpIGRvY3VtZW50LnRpdGxlID0gYXBwQ29uZmlnLkFwcF9UaXRsZTsKCiAgICAgICAgaWYoYXBwQ29uZmlnLkJ1dHRvbl9TdHlsZSkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zdGFydC1wcmFjdGljZScpLnN0eWxlLmNzc1RleHQgPSBhcHBDb25maWcuQnV0dG9uX1N0eWxlOwoKICAgICAgICBpZihhcHBDb25maWcuTG9nb19VUkwpIHsKICAgICAgICAgICAgY29uc3QgaW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcC1sb2dvJyk7CiAgICAgICAgICAgIGltZy5zcmMgPSBhcHBDb25maWcuTG9nb19VUkw7IAogICAgICAgICAgICBpbWcuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgfQoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluay10ZycpLmhyZWYgPSBhcHBDb25maWcuVGVsZWdyYW1fVVJMIHx8ICcjJzsKICAgICAgICAvLyBVU0UgSEFSRENPREVEIERFRkFVTFQgSUYgU0hFRVQgSVMgRU1QVFkKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluay13YScpLmhyZWYgPSBhcHBDb25maWcuV2hhdHNBcHBfVVJMIHx8IERFRkFVTFRfV0FfQ0hBTk5FTDsKCiAgICAgICAgaWYoYXBwQ29uZmlnLkN1c3RvbV9DU1MpIHsKICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOyAKICAgICAgICAgICAgc3R5bGUuaW5uZXJIVE1MID0gYXBwQ29uZmlnLkN1c3RvbV9DU1M7IAogICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTsKICAgICAgICB9CiAgICB9CgogICAgLyogLS0tIFNFU1NJT04gTUFOQUdFTUVOVCAtLS0gKi8KICAgIGZ1bmN0aW9uIGNoZWNrUmVzdW1lKCkgewogICAgICAgIGNvbnN0IHNhdmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2VyX3Nlc3Npb24nKTsKICAgICAgICBpZihzYXZlZCkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VtZS1iYXInKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgIH0KCiAgICBmdW5jdGlvbiBzYXZlU2Vzc2lvbigpIHsKICAgICAgICBpZih0aW1lclN0YXJ0ID09PSAwICYmIGVsYXBzZWRUaW1lID09PSAwKSByZXR1cm47CiAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IHsKICAgICAgICAgICAgcXM6IHF1ZXN0aW9ucywgaWR4OiBjdXJyZW50SW5kZXgsIGFuczogdXNlckFuc3dlcnMsIGJrOiBBcnJheS5mcm9tKGJvb2ttYXJrZWRRcyksCiAgICAgICAgICAgIHRpbWU6IE1hdGguZmxvb3IoKERhdGUubm93KCkgLSB0aW1lclN0YXJ0KS8xMDAwKSArIGVsYXBzZWRUaW1lLAogICAgICAgICAgICBuYW1lOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wLW5hbWUnKS52YWx1ZQogICAgICAgIH07CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2VyX3Nlc3Npb24nLCBKU09OLnN0cmluZ2lmeShzZXNzaW9uKSk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVzdW1lU2Vzc2lvbigpIHsKICAgICAgICBjb25zdCBzYXZlZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2VyX3Nlc3Npb24nKSk7CiAgICAgICAgaWYoIXNhdmVkKSByZXR1cm47CiAgICAgICAgcXVlc3Rpb25zID0gc2F2ZWQucXM7IGN1cnJlbnRJbmRleCA9IHNhdmVkLmlkeDsgdXNlckFuc3dlcnMgPSBzYXZlZC5hbnM7CiAgICAgICAgYm9va21hcmtlZFFzID0gbmV3IFNldChzYXZlZC5iayk7IGVsYXBzZWRUaW1lID0gc2F2ZWQudGltZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wLW5hbWUnKS52YWx1ZSA9IHNhdmVkLm5hbWUgfHwgIlN0dWRlbnQiOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3LXNldHVwJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctcXVpeicpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgICAgIHRpbWVyU3RhcnQgPSBEYXRlLm5vdygpOyB0aW1lckludGVydmFsID0gc2V0SW50ZXJ2YWwodXBkYXRlVGltZXIsIDEwMDApOwogICAgICAgIGxvYWRRdWVzdGlvblVJKCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNsZWFyU2Vzc2lvbigpIHsgCiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2VyX3Nlc3Npb24nKTsgCiAgICAgICAgaWYod2luZG93LnBhcmVudCAmJiB3aW5kb3cucGFyZW50LmxhdW5jaE1vZGUpIHdpbmRvdy5wYXJlbnQubGF1bmNoTW9kZSgncHJhY3RpY2UnKTsKICAgICAgICBlbHNlIHdpbmRvdy5wYXJlbnQubG9jYXRpb24ucmVsb2FkKCk7CiAgICB9CgogICAgLyogLS0tIERBVEEgJiBTRUxFQ1RJT04gLS0tICovCiAgICBmdW5jdGlvbiB1cGRhdGVTdHJlYW1zKCkgewogICAgICAgIGNvbnN0IGNscyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWwtY2xhc3MnKS52YWx1ZTsKICAgICAgICBjb25zdCBzdHJlYW1TZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsLXN0cmVhbScpOwogICAgICAgIHN0cmVhbVNlbC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgU3RyZWFtPC9vcHRpb24+JzsKICAgICAgICBzdHJlYW1TZWwuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICBzZWxlY3RlZENoYXB0ZXJzLmNsZWFyKCk7IAogICAgICAgIGxldCBvcHRzID0gW107CiAgICAgICAgaWYoY2xzID09PSAnMTAnKSBvcHRzID0gWydTdGFuZGFyZCAoQWxsIFN1YmplY3RzKSddOwogICAgICAgIGVsc2UgaWYoY2xzID09PSAnMTEnIHx8IGNscyA9PT0gJzEyJykgb3B0cyA9IFsnQk9BUkRTL1BDTScsICdCT0FSRFMvUENCJywgJ05FRVQnLCAnSkVFJ107CiAgICAgICAgZWxzZSBpZihjbHMgPT09ICdORUVUJyB8fCBjbHMgPT09ICdKRUUnKSBvcHRzID0gW2Nsc107CiAgICAgICAgZWxzZSBzdHJlYW1TZWwuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgIAogICAgICAgIG9wdHMuZm9yRWFjaChvID0+IHsgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsgZWwudmFsdWUgPSBvOyBlbC5pbm5lclRleHQgPSBvOyBzdHJlYW1TZWwuYXBwZW5kQ2hpbGQoZWwpOyB9KTsKICAgICAgICBpZihvcHRzLmxlbmd0aCA9PT0gMSkgeyBzdHJlYW1TZWwudmFsdWUgPSBvcHRzWzBdOyByZW5kZXJTdWJqZWN0QnV0dG9ucygpOyB9IAogICAgICAgIGVsc2UgeyByZW5kZXJTdWJqZWN0QnV0dG9ucygpOyB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGF0YUZvckNsYXNzKGNscykgewogICAgICAgIGlmIChjbHMgPT09ICdORUVUJyB8fCBjbHMgPT09ICdKRUUnKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbWJpbmVkID0ge307CiAgICAgICAgICAgIGlmKHRvcGljRGF0YVsnMTEnXSkgZm9yKGNvbnN0IHMgaW4gdG9waWNEYXRhWycxMSddKSBjb21iaW5lZFtzXSA9IFsuLi50b3BpY0RhdGFbJzExJ11bc11dOwogICAgICAgICAgICBpZih0b3BpY0RhdGFbJzEyJ10pIGZvcihjb25zdCBzIGluIHRvcGljRGF0YVsnMTInXSkgY29tYmluZWRbc10gPSAoY29tYmluZWRbc118fFtdKS5jb25jYXQodG9waWNEYXRhWycxMiddW3NdKTsKICAgICAgICAgICAgcmV0dXJuIGNvbWJpbmVkOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdG9waWNEYXRhW2Nsc10gfHwge307CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UmVsZXZhbnRDaGFwdGVycyhzdWJqZWN0LCBjbHMsIHN0cmVhbSkgewogICAgICAgIGNvbnN0IGRhdGEgPSBnZXREYXRhRm9yQ2xhc3MoY2xzKTsKICAgICAgICBpZiAoIWRhdGEgfHwgIWRhdGFbc3ViamVjdF0pIHJldHVybiBbXTsKICAgICAgICBjb25zdCBzdHJlYW1VcHBlciA9IHN0cmVhbS50b1VwcGVyQ2FzZSgpOwogICAgICAgIGNvbnN0IHNlbGVjdGVkTWVkaXVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbC1tZWRpdW0nKS52YWx1ZTsKCiAgICAgICAgcmV0dXJuIGRhdGFbc3ViamVjdF0uZmlsdGVyKGNoID0+IHsKICAgICAgICAgICAgY29uc3QgdGFncyA9IGNoLnRhZ3MgfHwgWydHRU5FUkFMJ107CiAgICAgICAgICAgIGxldCBpc1N0cmVhbU1hdGNoID0gZmFsc2U7CiAgICAgICAgICAgIGlmIChzdHJlYW1VcHBlci5pbmNsdWRlcygnTkVFVCcpIHx8IGNscyA9PT0gJ05FRVQnKSBpc1N0cmVhbU1hdGNoID0gdGFncy5zb21lKHQgPT4gdC5pbmNsdWRlcygnTkVFVCcpIHx8IHQgPT09ICdHRU5FUkFMJyk7CiAgICAgICAgICAgIGVsc2UgaWYgKHN0cmVhbVVwcGVyLmluY2x1ZGVzKCdKRUUnKSB8fCBjbHMgPT09ICdKRUUnKSBpc1N0cmVhbU1hdGNoID0gdGFncy5zb21lKHQgPT4gdC5pbmNsdWRlcygnSkVFJykgfHwgdCA9PT0gJ0dFTkVSQUwnKTsKICAgICAgICAgICAgZWxzZSBpZiAoc3RyZWFtVXBwZXIuaW5jbHVkZXMoJ0JPQVJEUycpIHx8IGNscyA9PT0gJzEwJykgaXNTdHJlYW1NYXRjaCA9IHRhZ3Muc29tZSh0ID0+IHQuaW5jbHVkZXMoJ0JPQVJEJykgfHwgdCA9PT0gJ0dFTkVSQUwnKTsKICAgICAgICAgICAgZWxzZSBpc1N0cmVhbU1hdGNoID0gdHJ1ZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBpc1N0cmVhbU1hdGNoICYmIChjaC5tZWRpdW0gPT09IHNlbGVjdGVkTWVkaXVtKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW5kZXJTdWJqZWN0QnV0dG9ucygpIHsKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3ViamVjdC1jb250YWluZXInKTsKICAgICAgICBjb25zdCBjbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsLWNsYXNzJykudmFsdWU7CiAgICAgICAgY29uc3Qgc3RyZWFtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbC1zdHJlYW0nKS52YWx1ZTsKICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgaWYoIWNscyB8fCAhc3RyZWFtKSB7IGNvbnRhaW5lci5pbm5lckhUTUwgPSAnPGRpdiBzdHlsZT0icGFkZGluZzoyMHB4OyB0ZXh0LWFsaWduOmNlbnRlcjsgYmFja2dyb3VuZDojZjhmYWZjOyBib3JkZXI6MnB4IGRhc2hlZCAjY2JkNWUxOyBib3JkZXItcmFkaXVzOjEycHg7IGNvbG9yOiM5NGEzYjg7IGZvbnQtc2l6ZToxM3B4OyI+U2VsZWN0IENsYXNzICYgU3RyZWFtIGZpcnN0PC9kaXY+JzsgcmV0dXJuOyB9CiAgICAgICAgCiAgICAgICAgY29uc3QgYWN0aXZlRGF0YSA9IGdldERhdGFGb3JDbGFzcyhjbHMpOwogICAgICAgIGNvbnN0IGF2YWlsYWJsZSA9IE9iamVjdC5rZXlzKGFjdGl2ZURhdGEpOwogICAgICAgIGNvbnN0IHN0cmVhbVVwcGVyID0gc3RyZWFtLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgCiAgICAgICAgbGV0IGFsbG93ZWRLZXl3b3JkcyA9IFtdOwogICAgICAgIGlmKHN0cmVhbVVwcGVyLmluY2x1ZGVzKCdQQ00nKSB8fCBzdHJlYW1VcHBlci5pbmNsdWRlcygnSkVFJykpIGFsbG93ZWRLZXl3b3JkcyA9IFsnUGh5c2ljcycsJ0NoZW0nLCdNYXRoJ107IAogICAgICAgIGVsc2UgaWYoc3RyZWFtVXBwZXIuaW5jbHVkZXMoJ1BDQicpIHx8IHN0cmVhbVVwcGVyLmluY2x1ZGVzKCdORUVUJykpIGFsbG93ZWRLZXl3b3JkcyA9IFsnUGh5c2ljcycsJ0NoZW0nLCdCaW8nLCdCb3RhbnknLCdab29sb2d5J107CgogICAgICAgIGxldCB2aXNpYmxlID0gMDsKICAgICAgICBhdmFpbGFibGUuZm9yRWFjaChzdWIgPT4gewogICAgICAgICAgICBsZXQgaXNBbGxvd2VkID0gdHJ1ZTsKICAgICAgICAgICAgaWYoYWxsb3dlZEtleXdvcmRzLmxlbmd0aCA+IDApIGlzQWxsb3dlZCA9IGFsbG93ZWRLZXl3b3Jkcy5zb21lKGsgPT4gc3ViLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoay50b0xvd2VyQ2FzZSgpKSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZihpc0FsbG93ZWQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlbGV2YW50Q2hhcHRlcnMgPSBnZXRSZWxldmFudENoYXB0ZXJzKHN1YiwgY2xzLCBzdHJlYW0pOwogICAgICAgICAgICAgICAgaWYocmVsZXZhbnRDaGFwdGVycy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZSsrOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgIGJ0bi5jbGFzc05hbWUgPSAnc3ViamVjdC1idG4nOwogICAgICAgICAgICAgICAgICAgIGJ0bi5pbm5lclRleHQgPSBzdWI7CiAgICAgICAgICAgICAgICAgICAgYnRuLm9uY2xpY2sgPSAoKSA9PiBvcGVuQ2hhcHRlck1vZGFsKHN1Yik7CiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGJ0bik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpZih2aXNpYmxlID09PSAwKSBjb250YWluZXIuaW5uZXJIVE1MID0gJzxwIHN0eWxlPSJwYWRkaW5nOjE1cHg7IHRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjojNjQ3NDhiOyI+Tm8gcmVsZXZhbnQgdG9waWNzIGZvdW5kIGZvciB0aGlzIE1lZGl1bS48L3A+JzsKICAgIH0KCiAgICBmdW5jdGlvbiBvcGVuQ2hhcHRlck1vZGFsKHN1YmplY3QpIHsKICAgICAgICBjb25zdCBjbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsLWNsYXNzJykudmFsdWU7CiAgICAgICAgY29uc3Qgc3RyZWFtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbC1zdHJlYW0nKS52YWx1ZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtc3ViamVjdC10aXRsZScpLmlubmVyVGV4dCA9IHN1YmplY3Q7CiAgICAgICAgY29uc3QgZ3JpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbC1jaGFwdGVyLWdyaWQnKTsKICAgICAgICBncmlkLmlubmVySFRNTCA9ICcnOwogICAgICAgIGNvbnN0IGNoYXB0ZXJzID0gZ2V0UmVsZXZhbnRDaGFwdGVycyhzdWJqZWN0LCBjbHMsIHN0cmVhbSk7CiAgICAgICAgCiAgICAgICAgY2hhcHRlcnMuZm9yRWFjaCgoY2gsIGlkeCkgPT4gewogICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgZGl2LmNsYXNzTmFtZSA9ICdjaGFwdGVyLWNoaXAnOwogICAgICAgICAgICBjb25zdCBzYWZlSUQgPSBgY2hfb3B0XyR7aWR4fWA7IAogICAgICAgICAgICBjb25zdCBpc0NoZWNrZWQgPSBzZWxlY3RlZENoYXB0ZXJzLmhhcyhjaC5uYW1lKTsKICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9IGA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSIke3NhZmVJRH0iIHZhbHVlPSIke2NoLm5hbWV9IiAke2lzQ2hlY2tlZCA/ICdjaGVja2VkJyA6ICcnfSBvbmNoYW5nZT0idG9nZ2xlQ2hhcHRlcignJHtjaC5uYW1lfScpIj48bGFiZWwgZm9yPSIke3NhZmVJRH0iPiR7Y2gubm99LiAke2NoLm5hbWV9PC9sYWJlbD5gOwogICAgICAgICAgICBncmlkLmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgfSk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXB0ZXItbW9kYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOyAKICAgIH0KCiAgICBmdW5jdGlvbiBjbG9zZU1vZGFsKGlkKSB7IAogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAKICAgICAgICBpZihpZCA9PT0gJ2NoYXB0ZXItbW9kYWwnKSB1cGRhdGVTdWJqZWN0U3R5bGVzKCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNsb3NlQWRtaW5Nc2coKSB7CiAgICAgICAgY2xvc2VNb2RhbCgnYWRtaW4tbXNnLW92ZXJsYXknKTsKICAgICAgICB0aW1lclN0YXJ0ID0gRGF0ZS5ub3coKTsgCiAgICAgICAgdGltZXJJbnRlcnZhbCA9IHNldEludGVydmFsKHVwZGF0ZVRpbWVyLCAxMDAwKTsKICAgICAgICBsb2FkUXVlc3Rpb25VSSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRvZ2dsZUNoYXB0ZXIoY2hOYW1lKSB7IAogICAgICAgIGlmKHNlbGVjdGVkQ2hhcHRlcnMuaGFzKGNoTmFtZSkpIHNlbGVjdGVkQ2hhcHRlcnMuZGVsZXRlKGNoTmFtZSk7IGVsc2Ugc2VsZWN0ZWRDaGFwdGVycy5hZGQoY2hOYW1lKTsgCiAgICB9CiAgICBmdW5jdGlvbiB1cGRhdGVTdWJqZWN0U3R5bGVzKCkgewogICAgICAgIGNvbnN0IGNscyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWwtY2xhc3MnKS52YWx1ZTsKICAgICAgICBjb25zdCBzdHJlYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsLXN0cmVhbScpLnZhbHVlOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdWJqZWN0LWJ0bicpLmZvckVhY2goYnRuID0+IHsKICAgICAgICAgICAgY29uc3QgY2hhcHRlcnMgPSBnZXRSZWxldmFudENoYXB0ZXJzKGJ0bi5pbm5lclRleHQsIGNscywgc3RyZWFtKTsKICAgICAgICAgICAgaWYoY2hhcHRlcnMuc29tZShjaCA9PiBzZWxlY3RlZENoYXB0ZXJzLmhhcyhjaC5uYW1lKSkpIGJ0bi5jbGFzc0xpc3QuYWRkKCdoYXMtc2VsZWN0aW9uJyk7CiAgICAgICAgICAgIGVsc2UgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hhcy1zZWxlY3Rpb24nKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBzdGFydFByYWN0aWNlKCkgewogICAgICAgIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wLW5hbWUnKS52YWx1ZTsKICAgICAgICBjb25zdCBjbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsLWNsYXNzJykudmFsdWU7CiAgICAgICAgY29uc3Qgc3RyZWFtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbC1zdHJlYW0nKS52YWx1ZTsKICAgICAgICBjb25zdCBtZWRpdW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsLW1lZGl1bScpLnZhbHVlOwogICAgICAgIGNvbnN0IGZpbmFsQ2hhcHRlcnMgPSBBcnJheS5mcm9tKHNlbGVjdGVkQ2hhcHRlcnMpOwoKICAgICAgICBpZighbmFtZSB8fCAhY2xzIHx8ICFzdHJlYW0pIHJldHVybiBhbGVydCgiUGxlYXNlIGZpbGwgYWxsIGRldGFpbHMiKTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctc2V0dXAnKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGVyLXRleHQnKS5pbm5lclRleHQgPSAiU2h1ZmZsaW5nIFF1ZXN0aW9ucy4uLiI7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dsb2JhbC1sb2FkZXInKS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwoKICAgICAgICBlbGFwc2VkVGltZSA9IDA7IHRpbWVyU3RhcnQgPSAwOyAKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGZldGNoQVBJKHsgYWN0aW9uOiAnZ2V0UXVlc3Rpb25zJywgY2xhc3NTZWxlY3Q6IGNscywgc3RyZWFtU2VsZWN0OiBzdHJlYW0sIG1lZGl1bTogbWVkaXVtLCBjaGFwdGVyczogZmluYWxDaGFwdGVycyB9KTsKICAgICAgICAgICAgaWYoZGF0YS5xdWVzdGlvbnMgJiYgZGF0YS5xdWVzdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgcXVlc3Rpb25zID0gZGF0YS5xdWVzdGlvbnM7IGN1cnJlbnRJbmRleCA9IDA7IHVzZXJBbnN3ZXJzID0ge307CiAgICAgICAgICAgICAgICBsb2FkUXVlc3Rpb25VSSgpOyAKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnbG9iYWwtbG9hZGVyJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3LXF1aXonKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKCiAgICAgICAgICAgICAgICBpZihhcHBDb25maWcuQWxlcnRfUHJhY3RpY2UpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRtaW4tbXNnLXRleHQnKS5pbm5lckhUTUwgPSBhcHBDb25maWcuQWxlcnRfUHJhY3RpY2U7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkbWluLW1zZy1vdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY2xvc2VBZG1pbk1zZygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgeyBhbGVydCgiTm8gcXVlc3Rpb25zIGZvdW5kLiIpOyBsb2NhdGlvbi5yZWxvYWQoKTsgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsgbG9jYXRpb24ucmVsb2FkKCk7IH0KICAgIH0KCiAgICBmdW5jdGlvbiBsb2FkUXVlc3Rpb25VSSgpIHsKICAgICAgICBpZighcXVlc3Rpb25zIHx8IHF1ZXN0aW9ucy5sZW5ndGggPT09IDApIHJldHVybjsKICAgICAgICBjb25zdCBxID0gcXVlc3Rpb25zW2N1cnJlbnRJbmRleF07CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzLWRpc3BsYXknKS5pbm5lclRleHQgPSBgJHtjdXJyZW50SW5kZXggKyAxfS8ke3F1ZXN0aW9ucy5sZW5ndGh9YDsKICAgICAgICBsZXQgdGFnSHRtbCA9IHEudGFnID8gYDxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kOiNmZWYzYzc7IGNvbG9yOiNkOTc3MDY7IHBhZGRpbmc6M3B4IDhweDsgYm9yZGVyLXJhZGl1czo2cHg7IGZvbnQtc2l6ZToxMXB4OyBtYXJnaW4tcmlnaHQ6NnB4OyI+JHtxLnRhZ308L3NwYW4+YCA6ICcnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxLWNvbnRlbnQnKS5pbm5lckhUTUwgPSB0YWdIdG1sICsgcS5xOwogICAgICAgIAogICAgICAgIGlmKHdpbmRvdy5NYXRoSmF4ICYmIHdpbmRvdy5NYXRoSmF4LnR5cGVzZXRQcm9taXNlKSB3aW5kb3cuTWF0aEpheC50eXBlc2V0UHJvbWlzZShbZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3EtY29udGVudCcpXSkuY2F0Y2goKCk9Pm51bGwpOwoKICAgICAgICBjb25zdCBia0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tYm9va21hcmsnKTsKICAgICAgICBpZihib29rbWFya2VkUXMuaGFzKGN1cnJlbnRJbmRleCkpIHsKICAgICAgICAgICAgYmtCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IGJrQnRuLmlubmVySFRNTCA9ICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjE4cHg7Ij7imIU8L3NwYW4+IFNhdmVkJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBia0J0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsgYmtCdG4uaW5uZXJIVE1MID0gJzxzcGFuIHN0eWxlPSJmb250LXNpemU6MThweDsiPuKYhTwvc3Bhbj4gU2F2ZSc7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBvcHRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3B0aW9ucy1jb250YWluZXInKTsKICAgICAgICBvcHRDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgcS5vLmZvckVhY2goKG9wdFRleHQsIGlkeCkgPT4gewogICAgICAgICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgYnRuLmNsYXNzTmFtZSA9ICdvcHRpb24nOwogICAgICAgICAgICBjb25zdCBsZXR0ZXJzID0gWydBJywnQicsJ0MnLCdEJ107CiAgICAgICAgICAgIGJ0bi5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz0ib3B0aW9uLWNpcmNsZSI+JHtsZXR0ZXJzW2lkeF19PC9kaXY+PGRpdj4ke29wdFRleHR9PC9kaXY+YDsKICAgICAgICAgICAgaWYod2luZG93Lk1hdGhKYXggJiYgd2luZG93Lk1hdGhKYXgudHlwZXNldFByb21pc2UpIHdpbmRvdy5NYXRoSmF4LnR5cGVzZXRQcm9taXNlKFtidG5dKS5jYXRjaCgoKT0+bnVsbCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZih1c2VyQW5zd2Vyc1tjdXJyZW50SW5kZXhdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGNvcnJlY3RJbmRleCA9IHBhcnNlSW50KHEuYykgLSAxOwogICAgICAgICAgICAgICAgaWYoaWR4ID09PSBjb3JyZWN0SW5kZXgpIGJ0bi5jbGFzc0xpc3QuYWRkKCdjb3JyZWN0Jyk7CiAgICAgICAgICAgICAgICBlbHNlIGlmKGlkeCA9PT0gdXNlckFuc3dlcnNbY3VycmVudEluZGV4XSkgYnRuLmNsYXNzTGlzdC5hZGQoJ3dyb25nJyk7CiAgICAgICAgICAgICAgICBidG4uc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsKICAgICAgICAgICAgfSBlbHNlIHsgYnRuLm9uY2xpY2sgPSAoKSA9PiBjaGVja0Fuc3dlcihpZHgsIHEuYywgcS5lLCBidG4pOyB9CiAgICAgICAgICAgIG9wdENvbnRhaW5lci5hcHBlbmRDaGlsZChidG4pOwogICAgICAgIH0pOwoKICAgICAgICBjb25zdCBleHBCb3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwbGFuYXRpb24tYm94Jyk7CiAgICAgICAgaWYodXNlckFuc3dlcnNbY3VycmVudEluZGV4XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGV4cEJveC5pbm5lckhUTUwgPSBgPGI+8J+SoSBFWFBMQU5BVElPTjo8L2I+PGJyPiR7cS5lIHx8ICdObyBleHBsYW5hdGlvbi4nfWA7CiAgICAgICAgICAgIGV4cEJveC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgaWYod2luZG93Lk1hdGhKYXggJiYgd2luZG93Lk1hdGhKYXgudHlwZXNldFByb21pc2UpIHdpbmRvdy5NYXRoSmF4LnR5cGVzZXRQcm9taXNlKFtleHBCb3hdKS5jYXRjaCgoKT0+bnVsbCk7CiAgICAgICAgfSBlbHNlIHsgZXhwQm94LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IH0KICAgICAgICAKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXByZXYnKS5kaXNhYmxlZCA9IChjdXJyZW50SW5kZXggPT09IDApOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tbmV4dCcpLmlubmVyVGV4dCA9IChjdXJyZW50SW5kZXggPT09IHF1ZXN0aW9ucy5sZW5ndGggLSAxKSA/ICJGaW5pc2giIDogIk5leHQiOwogICAgICAgIHNhdmVTZXNzaW9uKCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tBbnN3ZXIoc2VsZWN0ZWRJZHgsIGNvcnJlY3RPcHRSYXcsIGV4cGxhbmF0aW9uLCBidG5FbGVtZW50KSB7CiAgICAgICAgdXNlckFuc3dlcnNbY3VycmVudEluZGV4XSA9IHNlbGVjdGVkSWR4OyAKICAgICAgICBjb25zdCBjb3JyZWN0SW5kZXggPSBwYXJzZUludChjb3JyZWN0T3B0UmF3KSAtIDE7IAogICAgICAgIGNvbnN0IGFsbE9wdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3B0aW9uJyk7CiAgICAgICAgaWYoc2VsZWN0ZWRJZHggPT09IGNvcnJlY3RJbmRleCkgYnRuRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb3JyZWN0Jyk7CiAgICAgICAgZWxzZSB7IGJ0bkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnd3JvbmcnKTsgYWxsT3B0c1tjb3JyZWN0SW5kZXhdLmNsYXNzTGlzdC5hZGQoJ2NvcnJlY3QnKTsgfQogICAgICAgIGFsbE9wdHMuZm9yRWFjaChvID0+IG8uc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJyk7CiAgICAgICAgY29uc3QgZXhwQm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cGxhbmF0aW9uLWJveCcpOwogICAgICAgIGV4cEJveC5pbm5lckhUTUwgPSBgPGI+8J+SoSBFWFBMQU5BVElPTjo8L2I+PGJyPiR7ZXhwbGFuYXRpb24gfHwgJ05vIGV4cGxhbmF0aW9uLid9YDsKICAgICAgICBleHBCb3guc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgaWYod2luZG93Lk1hdGhKYXggJiYgd2luZG93Lk1hdGhKYXgudHlwZXNldFByb21pc2UpIHdpbmRvdy5NYXRoSmF4LnR5cGVzZXRQcm9taXNlKFtleHBCb3hdKS5jYXRjaCgoKT0+bnVsbCk7CiAgICAgICAgc2F2ZVNlc3Npb24oKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2dnbGVCb29rbWFyaygpIHsKICAgICAgICBpZihib29rbWFya2VkUXMuaGFzKGN1cnJlbnRJbmRleCkpIGJvb2ttYXJrZWRRcy5kZWxldGUoY3VycmVudEluZGV4KTsgZWxzZSBib29rbWFya2VkUXMuYWRkKGN1cnJlbnRJbmRleCk7CiAgICAgICAgbG9hZFF1ZXN0aW9uVUkoKTsgCiAgICB9CgogICAgZnVuY3Rpb24gcmVwb3J0RXJyb3IoKSB7CiAgICAgICAgbGV0IGRlc2MgPSBwcm9tcHQoIkRlc2NyaWJlIGlzc3VlIChvcHRpb25hbCk6IiwgIiIpOwogICAgICAgIGlmIChkZXNjID09PSBudWxsKSByZXR1cm47IAogICAgICAgIGNvbnN0IHEgPSBxdWVzdGlvbnNbY3VycmVudEluZGV4XTsKICAgICAgICBmZXRjaEFQSSh7IGFjdGlvbjogJ3JlcG9ydEVycm9yJywgcVRleHQ6IHEucSwgc3ViOiBxLnMsIHNoZWV0U3JjOiBxLnNyYywgcm93TnVtOiBxLnJvdywgZGVzY3JpcHRpb246IGRlc2MgfSk7CiAgICAgICAgYWxlcnQoIlJlcG9ydGVkLiBUaGFua3MhIik7CiAgICB9CgogICAgZnVuY3Rpb24gbmV4dFF1ZXN0aW9uKCkgeyBpZihjdXJyZW50SW5kZXggPCBxdWVzdGlvbnMubGVuZ3RoIC0gMSkgeyBjdXJyZW50SW5kZXgrKzsgbG9hZFF1ZXN0aW9uVUkoKTsgfSBlbHNlIGZpbmlzaFByYWN0aWNlKCk7IH0KICAgIGZ1bmN0aW9uIHByZXZRdWVzdGlvbigpIHsgaWYoY3VycmVudEluZGV4ID4gMCkgeyBjdXJyZW50SW5kZXgtLTsgbG9hZFF1ZXN0aW9uVUkoKTsgfSB9CgogICAgZnVuY3Rpb24gZmluaXNoUHJhY3RpY2UoKSB7CiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lckludGVydmFsKTsKICAgICAgICBjb25zdCB0b3RhbFRpbWUgPSAodGltZXJTdGFydCA+IDApID8gTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIHRpbWVyU3RhcnQpLzEwMDApICsgZWxhcHNlZFRpbWUgOiBlbGFwc2VkVGltZTsKICAgICAgICBsZXQgY29ycmVjdCA9IDA7CiAgICAgICAgY29uc3QgYXR0ZW1wdGVkID0gT2JqZWN0LmtleXModXNlckFuc3dlcnMpLmxlbmd0aDsKICAgICAgICBxdWVzdGlvbnMuZm9yRWFjaCgocSwgaWR4KSA9PiB7IGlmKHVzZXJBbnN3ZXJzW2lkeF0gIT09IHVuZGVmaW5lZCAmJiB1c2VyQW5zd2Vyc1tpZHhdID09PSAocGFyc2VJbnQocS5jKSAtIDEpKSBjb3JyZWN0Kys7IH0pOwogICAgICAgIAogICAgICAgIGxldCBhY2N1cmFjeSA9IGF0dGVtcHRlZCA+IDAgPyBNYXRoLnJvdW5kKChjb3JyZWN0IC8gYXR0ZW1wdGVkKSAqIDEwMCkgOiAwOwogICAgICAgIGNvbnN0IG0gPSBNYXRoLmZsb29yKHRvdGFsVGltZSAvIDYwKTsgY29uc3QgcyA9IHRvdGFsVGltZSAlIDYwOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzLXNjb3JlJykuaW5uZXJUZXh0ID0gYCR7Y29ycmVjdH0vJHtxdWVzdGlvbnMubGVuZ3RofWA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlcy1hY2N1cmFjeScpLmlubmVyVGV4dCA9IGAke2FjY3VyYWN5fSVgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXMtdGltZScpLmlubmVyVGV4dCA9IGAke219bSAke3N9c2A7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlcy13cm9uZycpLmlubmVyVGV4dCA9IGF0dGVtcHRlZCAtIGNvcnJlY3Q7CgogICAgICAgIGNvbnN0IG1zZ0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlcy1tc2cnKTsKICAgICAgICBpZihhY2N1cmFjeSA+PSA4MCkgbXNnRWwuaW5uZXJUZXh0ID0gYXBwQ29uZmlnLlJlc3VsdF9Nc2dfSGlnaCB8fCAi8J+UpSBPdXRzdGFuZGluZyBwZXJmb3JtYW5jZSEiOwogICAgICAgIGVsc2UgaWYoYWNjdXJhY3kgPj0gNTApIG1zZ0VsLmlubmVyVGV4dCA9IGFwcENvbmZpZy5SZXN1bHRfTXNnX0F2ZyB8fCAi8J+RjSBHb29kIEVmZm9ydCEgS2VlcCBwcmFjdGljaW5nLiI7CiAgICAgICAgZWxzZSBtc2dFbC5pbm5lclRleHQgPSBhcHBDb25maWcuUmVzdWx0X01zZ19Mb3cgfHwgIvCfk5ogRG9uJ3QgZ2l2ZSB1cCEgUmV2aWV3IHlvdXIgbWlzdGFrZXMuIjsKICAgICAgICAKICAgICAgICBpZihhcHBDb25maWcuUmVzdWx0X1Byb21vX0hUTUwpIHsKICAgICAgICAgICAgY29uc3QgcHJvbW9Cb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhbm5lbC1wcm9tbycpOwogICAgICAgICAgICBpZihwcm9tb0JveCkgcHJvbW9Cb3guaW5uZXJIVE1MID0gYXBwQ29uZmlnLlJlc3VsdF9Qcm9tb19IVE1MOwogICAgICAgIH0KCiAgICAgICAgLy8gLS0tIFVQREFURUQgV0hBVFNBUFAgU0hBUkUgVVJMIC0tLQogICAgICAgIGNvbnN0IHNoYXJlVGV4dCA9IGBJIHNjb3JlZCAke2NvcnJlY3R9LyR7cXVlc3Rpb25zLmxlbmd0aH0gaW4gdGhlIFByYWN0aWNlIFF1aXohIPCfjq9cbkFjY3VyYWN5OiAke2FjY3VyYWN5fSVcbkNhbiB5b3UgYmVhdCBtZT8gVHJ5IGhlcmU6YDsKICAgICAgICBjb25zdCBzaGFyZVVybCA9IGBodHRwczovL3dhLm1lLz90ZXh0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHNoYXJlVGV4dCl9JTIwJHtlbmNvZGVVUklDb21wb25lbnQoR0lUSFVCX1NIQVJFX1VSTCl9YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXNoYXJlLXdhJykuaHJlZiA9IHNoYXJlVXJsOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlldy1xdWl6JykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctcmVzdWx0JykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgY29uZmV0dGkoeyBwYXJ0aWNsZUNvdW50OiAxNTAsIHNwcmVhZDogNzAsIG9yaWdpbjogeyB5OiAwLjYgfSB9KTsKICAgICAgICBmZXRjaEFQSSh7IGFjdGlvbjogJ2xvZ1N0YXQnLCBtZXRyaWM6ICdDb21wbGV0ZXMnIH0pOwogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdlcl9zZXNzaW9uJyk7CiAgICB9CgogICAgLyogLS0tIFBSRU1JVU0gUERGIEVOR0lORSAtLS0gKi8KICAgIGZ1bmN0aW9uIGRvd25sb2FkUERGKCkgewogICAgICAgIGNvbnN0IHsganNQREYgfSA9IHdpbmRvdy5qc3BkZjsKICAgICAgICBjb25zdCBkb2MgPSBuZXcganNQREYoKTsKICAgICAgICAKICAgICAgICBmdW5jdGlvbiBjbGVhblRleHQoaHRtbCkgewogICAgICAgICAgICBjb25zdCB0ZW1wRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICAgIHRlbXBEaXYuaW5uZXJIVE1MID0gaHRtbDsKICAgICAgICAgICAgbGV0IHRleHQgPSB0ZW1wRGl2LmlubmVyVGV4dDsKICAgICAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvW1x1MjAxOFx1MjAxOV0vZywgIiciKSAKICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvW1x1MjAxQ1x1MjAxRF0vZywgJyInKSAKICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvW1x1MjAxM1x1MjAxNF0vZywgJy0nKSAKICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXHUwMEEwL2csICcgJykgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXHMrL2csICcgJykudHJpbSgpOwogICAgICAgICAgICByZXR1cm4gdGV4dDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRyYXdQYWdlTGF5b3V0KHBhZ2VOdW1iZXIpIHsKICAgICAgICAgICAgLy8gSEVBREVSCiAgICAgICAgICAgIGRvYy5zZXRGaWxsQ29sb3IoMzcsIDk5LCAyMzUpOyAKICAgICAgICAgICAgZG9jLnJlY3QoMCwgMCwgMjEwLCAyNSwgJ0YnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoMjU1LCAyNTUsIDI1NSk7CiAgICAgICAgICAgIGRvYy5zZXRGb250U2l6ZSgxNCk7IGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiYm9sZCIpOwogICAgICAgICAgICBkb2MudGV4dCgiUHJhY3RpY2UgU2Vzc2lvbiBSZXBvcnQg4oCiIEJ5IEV4YW0gUmVzY3VlIiwgMTA1LCAxMiwgeyBhbGlnbjogImNlbnRlciIgfSk7CiAgICAgICAgICAgIGRvYy5zZXRGb250U2l6ZSg5KTsgZG9jLnNldEZvbnQoImhlbHZldGljYSIsICJub3JtYWwiKTsKICAgICAgICAgICAgZG9jLnRleHQoIk1pc3Rha2VzICYgU2F2ZWQgUXVlc3Rpb25zIiwgMTA1LCAxOSwgeyBhbGlnbjogImNlbnRlciIgfSk7CgogICAgICAgICAgICAvLyBCT1JERVIKICAgICAgICAgICAgZG9jLnNldERyYXdDb2xvcigyMDAsIDIwMCwgMjAwKTsKICAgICAgICAgICAgZG9jLnNldExpbmVXaWR0aCgwLjUpOwogICAgICAgICAgICBkb2MucmVjdCg1LCA1LCAyMDAsIDI4Nyk7CgogICAgICAgICAgICAvLyBGT09URVIgQlVUVE9OUwogICAgICAgICAgICBkb2Muc2V0Rm9udFNpemUoOSk7IGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiYm9sZCIpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVGVsZWdyYW0gKEJsdWUpCiAgICAgICAgICAgIGRvYy5zZXRGaWxsQ29sb3IoMCwgMTM2LCAyMDQpOwogICAgICAgICAgICBkb2Mucm91bmRlZFJlY3QoMTAsIDI3OCwgNDAsIDEwLCAyLCAyLCAnRicpOwogICAgICAgICAgICBkb2Muc2V0VGV4dENvbG9yKDI1NSwgMjU1LCAyNTUpOwogICAgICAgICAgICBkb2MudGV4dCgiSm9pbiBUZWxlZ3JhbSIsIDMwLCAyODQsIHsgYWxpZ246ICdjZW50ZXInIH0pOwogICAgICAgICAgICBkb2MubGluaygxMCwgMjc4LCA0MCwgMTAsIHsgdXJsOiBhcHBDb25maWcuVGVsZWdyYW1fVVJMIHx8ICJodHRwczovL3RlbGVncmFtLm9yZyIgfSk7CgogICAgICAgICAgICAvLyBXaGF0c0FwcCAoR3JlZW4pCiAgICAgICAgICAgIC8vIFVQREFURUQ6IFVzZXMgeW91ciBzcGVjaWZpYyBDaGFubmVsIExpbmsgYXMgZGVmYXVsdAogICAgICAgICAgICBkb2Muc2V0RmlsbENvbG9yKDM3LCAyMTEsIDEwMik7CiAgICAgICAgICAgIGRvYy5yb3VuZGVkUmVjdCgxNjAsIDI3OCwgNDAsIDEwLCAyLCAyLCAnRicpOwogICAgICAgICAgICBkb2MudGV4dCgiSm9pbiBXaGF0c0FwcCIsIDE4MCwgMjg0LCB7IGFsaWduOiAnY2VudGVyJyB9KTsKICAgICAgICAgICAgZG9jLmxpbmsoMTYwLCAyNzgsIDQwLCAxMCwgeyB1cmw6IGFwcENvbmZpZy5XaGF0c0FwcF9VUkwgfHwgREVGQVVMVF9XQV9DSEFOTkVMIH0pOwoKICAgICAgICAgICAgLy8gUGFnZSAjCiAgICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoMTUwLCAxNTAsIDE1MCk7CiAgICAgICAgICAgIGRvYy50ZXh0KGBQYWdlICR7cGFnZU51bWJlcn1gLCAxMDUsIDI4NCwgeyBhbGlnbjogImNlbnRlciIgfSk7CiAgICAgICAgfQoKICAgICAgICBsZXQgeSA9IDM1OyAKICAgICAgICBsZXQgY291bnQgPSAwOwogICAgICAgIGxldCBwYWdlQ291bnQgPSAxOwoKICAgICAgICBkcmF3UGFnZUxheW91dCgxKTsgCgogICAgICAgIHF1ZXN0aW9ucy5mb3JFYWNoKChxLCBpZHgpID0+IHsKICAgICAgICAgICAgY29uc3QgaXNXcm9uZyA9IHVzZXJBbnN3ZXJzW2lkeF0gIT09IHVuZGVmaW5lZCAmJiB1c2VyQW5zd2Vyc1tpZHhdICE9PSAocGFyc2VJbnQocS5jKSAtIDEpOwogICAgICAgICAgICBjb25zdCBpc0Jvb2ttYXJrZWQgPSBib29rbWFya2VkUXMuaGFzKGlkeCk7CgogICAgICAgICAgICBpZiAoaXNXcm9uZyB8fCBpc0Jvb2ttYXJrZWQpIHsKICAgICAgICAgICAgICAgIGlmICh5ID4gMjYwKSB7IAogICAgICAgICAgICAgICAgICAgIGRvYy5hZGRQYWdlKCk7IAogICAgICAgICAgICAgICAgICAgIHBhZ2VDb3VudCsrOwogICAgICAgICAgICAgICAgICAgIGRyYXdQYWdlTGF5b3V0KHBhZ2VDb3VudCk7IAogICAgICAgICAgICAgICAgICAgIHkgPSAzNTsgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY291bnQrKzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZG9jLnNldEZvbnRTaXplKDkpOyBkb2Muc2V0Rm9udCgiaGVsdmV0aWNhIiwgImJvbGQiKTsKICAgICAgICAgICAgICAgIGxldCBiYWRnZVggPSAxMjsKICAgICAgICAgICAgICAgIGlmKGlzV3JvbmcpIHsKICAgICAgICAgICAgICAgICAgICBkb2Muc2V0RmlsbENvbG9yKDI1NCwgMjI2LCAyMjYpOyAvLyBMaWdodCBSZWQKICAgICAgICAgICAgICAgICAgICBkb2Muc2V0RHJhd0NvbG9yKDIzOSwgNjgsIDY4KTsKICAgICAgICAgICAgICAgICAgICBkb2MucmVjdChiYWRnZVgsIHktNCwgMjAsIDYsICdGRCcpOwogICAgICAgICAgICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoMTg1LCAyOCwgMjgpOwogICAgICAgICAgICAgICAgICAgIGRvYy50ZXh0KCJNSVNUQUtFIiwgYmFkZ2VYICsgMiwgeSk7CiAgICAgICAgICAgICAgICAgICAgYmFkZ2VYICs9IDI0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZihpc0Jvb2ttYXJrZWQpIHsKICAgICAgICAgICAgICAgICAgICBkb2Muc2V0RmlsbENvbG9yKDI1NCwgMjQzLCAxOTkpOyAvLyBMaWdodCBBbWJlcgogICAgICAgICAgICAgICAgICAgIGRvYy5zZXREcmF3Q29sb3IoMjQ1LCAxNTgsIDExKTsKICAgICAgICAgICAgICAgICAgICBkb2MucmVjdChiYWRnZVgsIHktNCwgMTYsIDYsICdGRCcpOwogICAgICAgICAgICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoMTgwLCA4MywgOSk7CiAgICAgICAgICAgICAgICAgICAgZG9jLnRleHQoIlNBVkVEIiwgYmFkZ2VYICsgMiwgeSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZG9jLnNldFRleHRDb2xvcigwLCAwLCAwKTsKICAgICAgICAgICAgICAgIGRvYy50ZXh0KGBRJHtjb3VudH0uYCwgMTAsIHkgKyAxMCk7CgogICAgICAgICAgICAgICAgeSArPSAxMDsKICAgICAgICAgICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAibm9ybWFsIik7IGRvYy5zZXRGb250U2l6ZSgxMSk7CiAgICAgICAgICAgICAgICBjb25zdCBjbGVhblEgPSBjbGVhblRleHQocS5xKTsKICAgICAgICAgICAgICAgIGNvbnN0IHNwbGl0USA9IGRvYy5zcGxpdFRleHRUb1NpemUoY2xlYW5RLCAxODApOwogICAgICAgICAgICAgICAgZG9jLnRleHQoc3BsaXRRLCAyMCwgeSk7IAogICAgICAgICAgICAgICAgeSArPSAoc3BsaXRRLmxlbmd0aCAqIDUpICsgNTsKCiAgICAgICAgICAgICAgICBjb25zdCBjb3JyZWN0VGV4dCA9IGNsZWFuVGV4dChxLm9bcGFyc2VJbnQocS5jKSAtIDFdKTsKICAgICAgICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoMjIsIDE2MywgNzQpOyAKICAgICAgICAgICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiYm9sZCIpOwogICAgICAgICAgICAgICAgZG9jLnRleHQoYOKckyBDb3JyZWN0IEFuc3dlcjogJHtjb3JyZWN0VGV4dH1gLCAyMCwgeSk7IAogICAgICAgICAgICAgICAgeSArPSA3OwoKICAgICAgICAgICAgICAgIGlmIChxLmUpIHsKICAgICAgICAgICAgICAgICAgICBkb2Muc2V0VGV4dENvbG9yKDYwLCA2MCwgNjApOwogICAgICAgICAgICAgICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiaXRhbGljIik7IGRvYy5zZXRGb250U2l6ZSgxMCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5FID0gY2xlYW5UZXh0KHEuZSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BsaXRFID0gZG9jLnNwbGl0VGV4dFRvU2l6ZSgiRXhwOiAiICsgY2xlYW5FLCAxNzUpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGRvYy5zZXRGaWxsQ29sb3IoMjQ4LCAyNTAsIDI1Mik7CiAgICAgICAgICAgICAgICAgICAgZG9jLnJlY3QoMTgsIHktNCwgMTgwLCAoc3BsaXRFLmxlbmd0aCAqIDUpICsgNiwgJ0YnKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBkb2MudGV4dChzcGxpdEUsIDIwLCB5KTsgCiAgICAgICAgICAgICAgICAgICAgeSArPSAoc3BsaXRFLmxlbmd0aCAqIDUpICsgMTU7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHkgKz0gMTA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZG9jLnNldERyYXdDb2xvcigyMzAsIDIzMCwgMjMwKTsKICAgICAgICAgICAgICAgIGRvYy5saW5lKDEwLCB5LTUsIDIwMCwgeS01KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAoY291bnQgPT09IDApIHsKICAgICAgICAgICAgZG9jLnNldEZvbnRTaXplKDE0KTsgZG9jLnNldFRleHRDb2xvcigwKTsKICAgICAgICAgICAgZG9jLnRleHQoIkV4Y2VsbGVudCEgTm8gbWlzdGFrZXMgb3Igc2F2ZWQgcXVlc3Rpb25zIHRvIHJlcG9ydC4iLCAxMDUsIDEwMCwgeyBhbGlnbjogImNlbnRlciIgfSk7CiAgICAgICAgfQoKICAgICAgICBkb2Muc2F2ZSgiUHJlbWl1bV9SZXBvcnRfRXhhbVJlc2N1ZS5wZGYiKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVUaW1lcigpIHsKICAgICAgICBpZih0aW1lclN0YXJ0ID09PSAwKSByZXR1cm47IAogICAgICAgIGNvbnN0IGRpZmYgPSBNYXRoLmZsb29yKChEYXRlLm5vdygpIC0gdGltZXJTdGFydCkgLyAxMDAwKSArIGVsYXBzZWRUaW1lOwogICAgICAgIGNvbnN0IG0gPSBNYXRoLmZsb29yKGRpZmYgLyA2MCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgIGNvbnN0IHMgPSAoZGlmZiAlIDYwKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWVyLWRpc3BsYXknKS5pbm5lclRleHQgPSBgJHttfToke3N9YDsKICAgIH0KCiAgICBmdW5jdGlvbiBzaG93TWFpbnRlbmFuY2UoZGF0YSkgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnbG9iYWwtbG9hZGVyJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlldy1zZXR1cCcpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3LW1haW50JykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW50LW1zZycpLmlubmVyVGV4dCA9IGRhdGEubWVzc2FnZTsKICAgICAgICBjb25zdCB0ZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWludC10ZycpOwogICAgICAgIGlmKGRhdGEubGlua3MgJiYgZGF0YS5saW5rcy50ZykgdGcuaHJlZiA9IGRhdGEubGlua3MudGc7CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hBUEkocGF5bG9hZCkgewogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKEFQSV9VUkwsIHsgbWV0aG9kOiAnUE9TVCcsIG1vZGU6ICdjb3JzJywgaGVhZGVyczogeydDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbjtjaGFyc2V0PXV0Zi04J30sIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpIH0pOwogICAgICAgIHJldHVybiBhd2FpdCByZXMuanNvbigpOwogICAgfQo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==</script>
    <script id="data-quiz" type="text/plain">PG1ldGEgbmFtZT0ndmlld3BvcnQnIGNvbnRlbnQ9J3dpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xJy8+PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9bm8iPgogICAgPHRpdGxlPkV4YW0gUmVzY3VlIFF1aXo8L3RpdGxlPgogICAgCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvanNwZGYvMi41LjEvanNwZGYudW1kLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9jYW52YXMtY29uZmV0dGlAMS42LjAvZGlzdC9jb25mZXR0aS5icm93c2VyLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcXJpb3VzLzQuMC4yL3FyaW91cy5taW4uanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBpZD0iTWF0aEpheC1zY3JpcHQiIGFzeW5jIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9tYXRoamF4QDMvZXM1L3RleC1tbWwtY2h0bWwuanMiPjwvc2NyaXB0PgogICAgCiAgICA8c3R5bGU+CiAgICAgICAgOnJvb3QgewogICAgICAgICAgICAtLXByaW1hcnk6ICM0ZjQ2ZTU7CiAgICAgICAgICAgIC0tcHJpbWFyeS1saWdodDogI2UwZTdmZjsKICAgICAgICAgICAgLS1yZXN1bHQtYnRuOiAjZjU5ZTBiOwogICAgICAgICAgICAtLXN1cmZhY2U6ICNmZmZmZmY7CiAgICAgICAgICAgIC0tYmc6ICNmM2Y0ZjY7CiAgICAgICAgICAgIC0tdGV4dDogIzFmMjkzNzsKICAgICAgICAgICAgLS1tdXRlZDogIzZiNzI4MDsKICAgICAgICB9CgogICAgICAgICogeyBib3gtc2l6aW5nOiBib3JkZXItYm94OyBtYXJnaW46IDA7IHBhZGRpbmc6IDA7IGZvbnQtZmFtaWx5OiAnSW50ZXInLCBzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIHNhbnMtc2VyaWY7IC13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjogdHJhbnNwYXJlbnQ7IH0KICAgICAgICBib2R5IHsgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmcpOyBjb2xvcjogdmFyKC0tdGV4dCk7IG1pbi1oZWlnaHQ6IDEwMHZoOyBvdmVyZmxvdy14OiBoaWRkZW47IGxpbmUtaGVpZ2h0OiAxLjU7IHBhZGRpbmctYm90dG9tOiA0MHB4O30KCiAgICAgICAgLyogLS0tIExBWU9VVCAtLS0gKi8KICAgICAgICAuY29udGFpbmVyIHsgbWF4LXdpZHRoOiA1MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7IH0KICAgICAgICAKICAgICAgICAuY2FyZCB7IAogICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlKTsgYm9yZGVyLXJhZGl1czogMjRweDsgcGFkZGluZzogMjVweDsgCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyNXB4IC01cHggcmdiYSgwLDAsMCwwLjEpOyAKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tYm90dG9tOiAyMHB4OyBhbmltYXRpb246IHNsaWRlVXAgMC40cyBlYXNlLW91dDsKICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOyBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgIH0KICAgICAgICBAa2V5ZnJhbWVzIHNsaWRlVXAgeyBmcm9tIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDIwcHgpOyBvcGFjaXR5OiAwOyB9IHRvIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyBvcGFjaXR5OiAxOyB9IH0KCiAgICAgICAgaDIgeyBmb250LXNpemU6IDIycHg7IGZvbnQtd2VpZ2h0OiA4MDA7IGNvbG9yOiAjMTExODI3OyBtYXJnaW4tYm90dG9tOiA1cHg7IH0KICAgICAgICBwLnN1YnRpdGxlIHsgY29sb3I6IHZhcigtLW11dGVkKTsgZm9udC1zaXplOiAxM3B4OyBtYXJnaW4tYm90dG9tOiAyNXB4OyB9CgogICAgICAgIC8qIC0tLSBTRUxFQ1RJT04gR1JJRFMgLS0tICovCiAgICAgICAgLnNlY3Rpb24tbGFiZWwgeyBkaXNwbGF5OiBibG9jazsgdGV4dC1hbGlnbjogbGVmdDsgZm9udC1zaXplOiAxMXB4OyBmb250LXdlaWdodDogODAwOyBjb2xvcjogdmFyKC0tbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiAxMHB4OyBsZXR0ZXItc3BhY2luZzogMC41cHg7IHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7IH0KICAgICAgICAKICAgICAgICAuZ3JpZC1zZWxlY3QgeyBkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCgyLCAxZnIpOyBnYXA6IDEycHg7IG1hcmdpbi1ib3R0b206IDIwcHg7IH0KICAgICAgICAKICAgICAgICAuc2VsZWN0LWNhcmQgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZjlmYWZiOyBib3JkZXI6IDJweCBzb2xpZCAjZTVlN2ViOyBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgICAgICAgICBwYWRkaW5nOiAxNnB4OyBjdXJzb3I6IHBvaW50ZXI7IHRyYW5zaXRpb246IGFsbCAwLjJzOyBmb250LXdlaWdodDogNjAwOyBmb250LXNpemU6IDE0cHg7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBnYXA6IDhweDsKICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQpOwogICAgICAgIH0KICAgICAgICAuc2VsZWN0LWNhcmQ6YWN0aXZlIHsgdHJhbnNmb3JtOiBzY2FsZSgwLjk4KTsgfQogICAgICAgIC5zZWxlY3QtY2FyZC5hY3RpdmUgeyBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnkpOyBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWxpZ2h0KTsgY29sb3I6IHZhcigtLXByaW1hcnkpOyBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoNzksIDcwLCAyMjksIDAuMTUpOyB9CiAgICAgICAgLnNlbGVjdC1jYXJkIHNwYW4geyBmb250LXNpemU6IDIycHg7IH0gCgogICAgICAgIC8qIC0tLSBJTlBVVFMgLS0tICovCiAgICAgICAgLm1vZGVybi1pbnB1dCB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOyBwYWRkaW5nOiAxNnB4OyBiYWNrZ3JvdW5kOiAjZjlmYWZiOyBib3JkZXI6IDJweCBzb2xpZCAjZTVlN2ViOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxNHB4OyBmb250LXNpemU6IDE1cHg7IGZvbnQtd2VpZ2h0OiA2MDA7IG91dGxpbmU6IG5vbmU7IHRyYW5zaXRpb246IDAuMnM7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDE1cHg7CiAgICAgICAgfQogICAgICAgIC5tb2Rlcm4taW5wdXQ6Zm9jdXMgeyBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnkpOyBiYWNrZ3JvdW5kOiAjZmZmOyB9CiAgICAgICAgCiAgICAgICAgLmRyb3Bkb3duLXdyYXBwZXIgeyBwb3NpdGlvbjogcmVsYXRpdmU7IG1hcmdpbi1ib3R0b206IDE1cHg7IH0KICAgICAgICAuZHJvcGRvd24td3JhcHBlcjo6YWZ0ZXIgeyBjb250ZW50OiAn4pa8JzsgcG9zaXRpb246IGFic29sdXRlOyByaWdodDogMTVweDsgdG9wOiAyMHB4OyBmb250LXNpemU6IDEwcHg7IGNvbG9yOiB2YXIoLS1tdXRlZCk7IHBvaW50ZXItZXZlbnRzOiBub25lOyB9CiAgICAgICAgc2VsZWN0Lm1vZGVybi1pbnB1dCB7IGFwcGVhcmFuY2U6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsgfQoKICAgICAgICAvKiAtLS0gQlVUVE9OUyAtLS0gKi8KICAgICAgICAuYnRuIHsgd2lkdGg6IDEwMCU7IHBhZGRpbmc6IDE4cHg7IGJvcmRlci1yYWRpdXM6IDE2cHg7IGZvbnQtc2l6ZTogMTZweDsgZm9udC13ZWlnaHQ6IDcwMDsgYm9yZGVyOiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IHRyYW5zaXRpb246IDAuMnM7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBnYXA6IDhweDsgbWFyZ2luLWJvdHRvbTogMTJweDsgfQogICAgICAgIC5idG46YWN0aXZlIHsgdHJhbnNmb3JtOiBzY2FsZSgwLjk4KTsgfQogICAgICAgIAogICAgICAgIC5idG4tcHJpbWFyeSB7IGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnkpOyBjb2xvcjogd2hpdGU7IGJveC1zaGFkb3c6IDAgOHB4IDIwcHggLTVweCByZ2JhKDc5LCA3MCwgMjI5LCAwLjQpOyB9CiAgICAgICAgLmJ0bi1jaGVjay1yZXN1bHQgeyBiYWNrZ3JvdW5kOiB2YXIoLS1yZXN1bHQtYnRuKTsgY29sb3I6IHdoaXRlOyBib3gtc2hhZG93OiAwIDhweCAyMHB4IC01cHggcmdiYSgyNDUsIDE1OCwgMTEsIDAuNCk7IGJvcmRlcjogMnB4IHNvbGlkICNkOTc3MDY7IH0KICAgICAgICAuYnRuLW91dGxpbmUgeyBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgYm9yZGVyOiAycHggc29saWQgI2U1ZTdlYjsgY29sb3I6IHZhcigtLXRleHQpOyB9CiAgICAgICAgCiAgICAgICAgLyogTmF2IEJ1dHRvbnMgKi8KICAgICAgICAubmF2LWJhciB7IHBvc2l0aW9uOmZpeGVkOyBib3R0b206MDsgbGVmdDowOyByaWdodDowOyBiYWNrZ3JvdW5kOndoaXRlOyBwYWRkaW5nOjE1cHg7IGRpc3BsYXk6ZmxleDsgZ2FwOjhweDsgYm9yZGVyLXRvcDoxcHggc29saWQgI2U1ZTdlYjsgbWF4LXdpZHRoOjUwMHB4OyBtYXJnaW46MCBhdXRvOyB6LWluZGV4OjEwMDsgfQogICAgICAgIC5idG4tbmF2IHsgZmxleDogMTsgcGFkZGluZzogMTRweDsgZm9udC1zaXplOiAxNHB4OyBtYXJnaW46IDA7IH0KICAgICAgICAuYnRuLXNraXAgeyBiYWNrZ3JvdW5kOiAjZjNmNGY2OyBjb2xvcjogdmFyKC0tdGV4dCk7IGJvcmRlcjogMXB4IHNvbGlkICNlNWU3ZWI7IH0KCiAgICAgICAgLyogLS0tIFJFU1VMVCBQQUdFIC0tLSAqLwogICAgICAgIC5yYW5rLWNpcmNsZSB7CiAgICAgICAgICAgIHdpZHRoOiAxMjBweDsgaGVpZ2h0OiAxMjBweDsgYm9yZGVyLXJhZGl1czogNTAlOyAKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2UwZTdmZiAwJSwgI2ZmZmZmZiAxMDAlKTsKICAgICAgICAgICAgYm9yZGVyOiA1cHggc29saWQgdmFyKC0tcHJpbWFyeSk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBtYXJnaW46IDAgYXV0byAxMHB4IGF1dG87IHBvc2l0aW9uOiByZWxhdGl2ZTsgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggLTEwcHggcmdiYSg3OSwgNzAsIDIyOSwgMC41KTsKICAgICAgICB9CiAgICAgICAgLnJhbmstbnVtIHsgZm9udC1zaXplOiAzNnB4OyBmb250LXdlaWdodDogOTAwOyBjb2xvcjogdmFyKC0tcHJpbWFyeSk7IGxpbmUtaGVpZ2h0OiAxOyB9CiAgICAgICAgLnJhbmstbGFiZWwgeyBmb250LXNpemU6IDExcHg7IGZvbnQtd2VpZ2h0OiA3MDA7IGNvbG9yOiB2YXIoLS1tdXRlZCk7IHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7IG1hcmdpbi10b3A6IDJweDsgfQogICAgICAgIAogICAgICAgIC5yYW5rLXRvdGFsLXBpbGwgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMWYyOTM3OyBjb2xvcjogd2hpdGU7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgCiAgICAgICAgICAgIHBhZGRpbmc6IDRweCAxMnB4OyBib3JkZXItcmFkaXVzOiA5OXB4OyBmb250LXNpemU6IDEycHg7IGZvbnQtd2VpZ2h0OiA3MDA7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDI1cHg7CiAgICAgICAgfQoKICAgICAgICAuc3RhdC1yb3cgeyBkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IHBhZGRpbmc6IDE2cHg7IGJhY2tncm91bmQ6ICNmOWZhZmI7IGJvcmRlci1yYWRpdXM6IDE0cHg7IG1hcmdpbi1ib3R0b206IDEwcHg7IGZvbnQtd2VpZ2h0OiA2MDA7IGZvbnQtc2l6ZTogMTRweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgfQogICAgICAgIC5zdGF0LXZhbCB7IGZvbnQtd2VpZ2h0OiA4MDA7IGNvbG9yOiB2YXIoLS10ZXh0KTsgZm9udC1zaXplOiAxNnB4OyB9CgogICAgICAgIC8qIC0tLSBMT0NLIE9WRVJMQVkgLS0tICovCiAgICAgICAgI2xvY2stb3ZlcmxheSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgaW5zZXQ6IDA7IGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45Nik7CiAgICAgICAgICAgIHotaW5kZXg6IDUwOyBkaXNwbGF5OiBub25lOyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICAgICAgcGFkZGluZzogMjBweDsgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDVweCk7CiAgICAgICAgfQogICAgICAgIC5sb2NrLWljb24geyBmb250LXNpemU6IDQwcHg7IG1hcmdpbi1ib3R0b206IDE1cHg7IH0KICAgICAgICAubG9jay10aXRsZSB7IGZvbnQtc2l6ZTogMjBweDsgZm9udC13ZWlnaHQ6IDgwMDsgY29sb3I6ICMxZjI5Mzc7IG1hcmdpbi1ib3R0b206IDVweDsgfQogICAgICAgIC5sb2NrLXN1YiB7IGZvbnQtc2l6ZTogMTNweDsgY29sb3I6ICM2YjcyODA7IG1hcmdpbi1ib3R0b206IDI1cHg7IG1heC13aWR0aDogMjgwcHg7IH0KCiAgICAgICAgLyogLS0tIENIQUxMRU5HRSBCVVRUT04gLS0tICovCiAgICAgICAgLmJ0bi1jaGFsbGVuZ2UgeyBiYWNrZ3JvdW5kOiAjMjVEMzY2OyBjb2xvcjogd2hpdGU7IGJveC1zaGFkb3c6IDAgOHB4IDIwcHggLTVweCByZ2JhKDM3LCAyMTEsIDEwMiwgMC40KTsgbWFyZ2luLWJvdHRvbTogMjBweDsgfQoKICAgICAgICAvKiAtLS0gQ0VSVElGSUNBVEUgVElFUlMgLS0tICovCiAgICAgICAgLmNlcnQtYnRuIHsgZGlzcGxheTogbm9uZTsgbWFyZ2luLXRvcDogNXB4O30gCiAgICAgICAgLmNlcnQtYnRuLmVsaXRlIHsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2Q5NzcwNiwgI2ZiYmYyNCk7IGNvbG9yOiB3aGl0ZTsgZGlzcGxheTogZmxleDsgYm94LXNoYWRvdzogMCAxMHB4IDIwcHggLTVweCByZ2JhKDIxNywgMTE5LCA2LCAwLjQpOyB9CiAgICAgICAgLmNlcnQtYnRuLnNpbHZlciB7IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM0NzU1NjksICM5NGEzYjgpOyBjb2xvcjogd2hpdGU7IGRpc3BsYXk6IGZsZXg7IGJveC1zaGFkb3c6IDAgMTBweCAyMHB4IC01cHggcmdiYSg3MSwgODUsIDEwNSwgMC40KTsgfQogICAgICAgIC5jZXJ0LWJ0bi5icm9uemUgeyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNzgzNTBmLCAjYjQ1MzA5KTsgY29sb3I6IHdoaXRlOyBkaXNwbGF5OiBmbGV4OyBib3gtc2hhZG93OiAwIDEwcHggMjBweCAtNXB4IHJnYmEoMTIwLCA1MywgMTUsIDAuNCk7IH0KCiAgICAgICAgLyogLS0tIFFVSVogVUkgLS0tICovCiAgICAgICAgLmV4YW0tdGFnIHsKICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyBiYWNrZ3JvdW5kOiAjZmVlMmUyOyBjb2xvcjogI2I5MWMxYzsgCiAgICAgICAgICAgIHBhZGRpbmc6IDRweCAxMHB4OyBib3JkZXItcmFkaXVzOiA2cHg7IGZvbnQtc2l6ZTogMTJweDsgZm9udC13ZWlnaHQ6IDgwMDsgCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEycHg7IHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5vcHRpb24tYm94IHsgCiAgICAgICAgICAgIHBhZGRpbmc6IDE4cHg7IGJvcmRlcjogMnB4IHNvbGlkICNlNWU3ZWI7IGJvcmRlci1yYWRpdXM6IDE2cHg7IG1hcmdpbi1ib3R0b206IDEycHg7IAogICAgICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OyBmb250LXdlaWdodDogNjAwOyBjdXJzb3I6IHBvaW50ZXI7IHRyYW5zaXRpb246IDAuMnM7IHBvc2l0aW9uOiByZWxhdGl2ZTsgZm9udC1zaXplOiAxNXB4OwogICAgICAgIH0KICAgICAgICAub3B0aW9uLWJveC5zZWxlY3RlZCB7IGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeSk7IGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktbGlnaHQpOyBjb2xvcjogdmFyKC0tcHJpbWFyeSk7IH0KICAgICAgICAub3B0aW9uLWJveC5jb3JyZWN0IHsgYm9yZGVyLWNvbG9yOiAjMTBiOTgxOyBiYWNrZ3JvdW5kOiAjZDFmYWU1OyBjb2xvcjogIzA0Nzg1NzsgfQogICAgICAgIC5vcHRpb24tYm94Lndyb25nIHsgYm9yZGVyLWNvbG9yOiAjZWY0NDQ0OyBiYWNrZ3JvdW5kOiAjZmVlMmUyOyBjb2xvcjogI2I5MWMxYzsgfQogICAgICAgIC5leHBsYW5hdGlvbiB7IGJhY2tncm91bmQ6ICNlZmY2ZmY7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDE2cHg7IHRleHQtYWxpZ246IGxlZnQ7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICMxZTQwYWY7IGRpc3BsYXk6IG5vbmU7IG1hcmdpbi10b3A6IDE1cHg7IGJvcmRlci1sZWZ0OiA1cHggc29saWQgdmFyKC0tcHJpbWFyeSk7IGxpbmUtaGVpZ2h0OiAxLjY7IH0KCiAgICAgICAgLyogLS0tIENVU1RPTSBBRE1JTiBBTEVSVCAoR0xBU1NNT1JQSElTTSkgLS0tICovCiAgICAgICAgI2N1c3RvbS1hbGVydC1vdmVybGF5IHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOyBpbnNldDogMDsgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjYpOyBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoOHB4KTsKICAgICAgICAgICAgei1pbmRleDogMjAwMDsgZGlzcGxheTogbm9uZTsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgfQogICAgICAgIC5nbGFzcy1hbGVydCB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45NSk7IHdpZHRoOiA5MCU7IG1heC13aWR0aDogNDAwcHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDI0cHg7IHBhZGRpbmc6IDMwcHg7IHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAyMHB4IDUwcHggcmdiYSgwLDAsMCwwLjIpOwogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC41KTsKICAgICAgICAgICAgYW5pbWF0aW9uOiBwb3BJbiAwLjNzIGN1YmljLWJlemllcigwLjE3NSwgMC44ODUsIDAuMzIsIDEuMjc1KTsKICAgICAgICB9CiAgICAgICAgQGtleWZyYW1lcyBwb3BJbiB7IGZyb20geyB0cmFuc2Zvcm06IHNjYWxlKDAuOCk7IG9wYWNpdHk6IDA7IH0gdG8geyB0cmFuc2Zvcm06IHNjYWxlKDEpOyBvcGFjaXR5OiAxOyB9IH0KICAgICAgICAKICAgICAgICAuYWxlcnQtaGVhZGVyIHsgZm9udC13ZWlnaHQ6IDgwMDsgZm9udC1zaXplOiAxNHB4OyBjb2xvcjogdmFyKC0tcHJpbWFyeSk7IHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7IG1hcmdpbi1ib3R0b206IDE1cHg7IGxldHRlci1zcGFjaW5nOiAxcHg7IH0KICAgICAgICAuYWxlcnQtbXNnIHsgZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzM3NDE1MTsgbGluZS1oZWlnaHQ6IDEuNjsgbWFyZ2luLWJvdHRvbTogMTBweDsgZm9udC13ZWlnaHQ6IDUwMDsgfQogICAgICAgIC5hbGVydC1jbG9zZS1pY29uIHsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDE1cHg7IHJpZ2h0OiAxNXB4OwogICAgICAgICAgICB3aWR0aDogMzJweDsgaGVpZ2h0OiAzMnB4OyBiYWNrZ3JvdW5kOiAjZjNmNGY2OyBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7IGNvbG9yOiAjNmI3MjgwOyBmb250LXdlaWdodDogYm9sZDsgdHJhbnNpdGlvbjogMC4yczsKICAgICAgICB9CiAgICAgICAgLmFsZXJ0LWNsb3NlLWljb246aG92ZXIgeyBiYWNrZ3JvdW5kOiAjZmVlMmUyOyBjb2xvcjogI2VmNDQ0NDsgfQoKICAgICAgICAvKiAtLS0gTE9BREVSIC0tLSAqLwogICAgICAgICNsb2FkZXIgeyBwb3NpdGlvbjogZml4ZWQ7IGluc2V0OiAwOyBiYWNrZ3JvdW5kOiB3aGl0ZTsgei1pbmRleDogOTk5OyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgfQogICAgICAgIC5zcGlubmVyIHsgd2lkdGg6IDUwcHg7IGhlaWdodDogNTBweDsgYm9yZGVyOiA1cHggc29saWQgI2U1ZTdlYjsgYm9yZGVyLXRvcC1jb2xvcjogdmFyKC0tcHJpbWFyeSk7IGJvcmRlci1yYWRpdXM6IDUwJTsgYW5pbWF0aW9uOiBzcGluIDAuOHMgbGluZWFyIGluZmluaXRlOyBtYXJnaW4tYm90dG9tOiAyMHB4OyB9CiAgICAgICAgQGtleWZyYW1lcyBzcGluIHsgdG8geyB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOyB9IH0KICAgICAgICAuaGlkZGVuIHsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmdyaWQtc2VsZWN0LnN0cmVhbXMgeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjsgfSAKICAgIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CgogICAgPGRpdiBpZD0ibG9hZGVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzcGlubmVyIj48L2Rpdj4KICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDogODAwOyBmb250LXNpemU6IDIwcHg7IiBpZD0ibG9hZGVyLXR4dCI+RXhhbSBSZXNjdWU8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9ImN1c3RvbS1hbGVydC1vdmVybGF5Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJnbGFzcy1hbGVydCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImFsZXJ0LWNsb3NlLWljb24iIG9uY2xpY2s9ImNsb3NlQ3VzdG9tQWxlcnQoKSI+4pyVPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImFsZXJ0LWhlYWRlciI+TWVzc2FnZSBmcm9tIEFkbWluPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImFsZXJ0LW1zZyIgaWQ9ImN1c3RvbS1hbGVydC1tc2ciPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCiAgICAgICAgPGRpdiBpZD0idmlldy1ob21lIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgICAgICAgICA8aW1nIGlkPSJsb2dvLWltZyIgc3JjPSIiIHN0eWxlPSJ3aWR0aDo2MHB4OyBoZWlnaHQ6NjBweDsgYm9yZGVyLXJhZGl1czoxNHB4OyBtYXJnaW4tYm90dG9tOjEycHg7IGRpc3BsYXk6bm9uZTsiPgogICAgICAgICAgICAgICAgPGgyIGlkPSJhcHAtdGl0bGUiPkV4YW0gUmVzY3VlPC9oMj4KICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJzdWJ0aXRsZSI+U2VsZWN0IHlvdXIgY2F0ZWdvcnkgdG8gYmVnaW48L3A+CgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNlY3Rpb24tbGFiZWwiPjEuIFNFTEVDVCBDQVRFR09SWTwvc3Bhbj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQtc2VsZWN0Ij4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWxlY3QtY2FyZCIgb25jbGljaz0ic2VsZWN0Q2xhc3ModGhpcywgJzEwJykiPjxzcGFuPvCfk508L3NwYW4+Q2xhc3MgMTA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWxlY3QtY2FyZCIgb25jbGljaz0ic2VsZWN0Q2xhc3ModGhpcywgJzExJykiPjxzcGFuPuKam++4jzwvc3Bhbj5DbGFzcyAxMTwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlbGVjdC1jYXJkIiBvbmNsaWNrPSJzZWxlY3RDbGFzcyh0aGlzLCAnMTInKSI+PHNwYW4+8J+Okzwvc3Bhbj5DbGFzcyAxMjwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlbGVjdC1jYXJkIiBvbmNsaWNrPSJzZWxlY3RDbGFzcyh0aGlzLCAnRnVsbC9Ecm9wcGVyJykiPjxzcGFuPvCfkqo8L3NwYW4+RnVsbC9Ecm9wcGVyPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJkaXYtc3RyZWFtIiBjbGFzcz0iaGlkZGVuIj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2VjdGlvbi1sYWJlbCI+Mi4gU0VMRUNUIFNUUkVBTTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJncmlkLXNlbGVjdCIgaWQ9InN0cmVhbS1ncmlkIj48L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImRpdi1tZWRpdW0iIGNsYXNzPSJoaWRkZW4iPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzZWN0aW9uLWxhYmVsIj4zLiBTRUxFQ1QgTUVESVVNPC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQtc2VsZWN0Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic2VsZWN0LWNhcmQiIG9uY2xpY2s9InNlbGVjdE1lZGl1bSh0aGlzLCAnRW5nbGlzaCcpIj5FbmdsaXNoIE1lZGl1bTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWxlY3QtY2FyZCIgb25jbGljaz0ic2VsZWN0TWVkaXVtKHRoaXMsICdIaW5kaScpIj5IaW5kaSBNZWRpdW08L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6IDMwcHg7Ij4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIG9uY2xpY2s9InByb2NlZWRUb0RldGFpbHMoJ3F1aXonKSI+U3RhcnQgTmV3IFF1aXog8J+agDwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tY2hlY2stcmVzdWx0IiBvbmNsaWNrPSJwcm9jZWVkVG9EZXRhaWxzKCdyYW5rJykiPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjIwcHg7Ij7wn5OKPC9zcGFuPiBDaGVjayBSZXN1bHRzCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJib3JkZXItdG9wOiAxcHggc29saWQgI2U1ZTdlYjsgbWFyZ2luOiAzMHB4IDAgMTVweCAwOyI+PC9kaXY+CiAgICAgICAgICAgICAgICA8cCBzdHlsZT0iZm9udC1zaXplOjEycHg7IGZvbnQtd2VpZ2h0OjgwMDsgY29sb3I6dmFyKC0tbXV0ZWQpOyBtYXJnaW4tYm90dG9tOjEycHg7IHRleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTsiPkpvaW4gT3VyIENvbW11bml0eTwvcD4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ3JpZC1zZWxlY3QiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlbGVjdC1jYXJkIiBvbmNsaWNrPSJvcGVuTGluaygnd2EnKSIgc3R5bGU9ImJvcmRlci1jb2xvcjojMjVEMzY2OyBjb2xvcjojMjVEMzY2OyBiYWNrZ3JvdW5kOiNmMGZkZjQ7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToyNnB4OyI+8J+SrDwvc3Bhbj4gV2hhdHNBcHAKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWxlY3QtY2FyZCIgb25jbGljaz0ib3BlbkxpbmsoJ3RnJykiIHN0eWxlPSJib3JkZXItY29sb3I6IzIyOUVEOTsgY29sb3I6IzIyOUVEOTsgYmFja2dyb3VuZDojZjBmOWZmOyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MjZweDsiPuKciO+4jzwvc3Bhbj4gVGVsZWdyYW0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgaWQ9InZpZXctZGV0YWlscyIgY2xhc3M9ImhpZGRlbiI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgICAgICAgICAgPGgyIGlkPSJkZXRhaWxzLWhlYWRlciI+RW50ZXIgSW5mbzwvaDI+CiAgICAgICAgICAgICAgICA8cCBjbGFzcz0ic3VidGl0bGUiPlNlY3VyZSBMb2dpbjwvcD4KCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2VjdGlvbi1sYWJlbCI+WU9VUiBERVRBSUxTPC9zcGFuPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJpbnAtbmFtZSIgY2xhc3M9Im1vZGVybi1pbnB1dCIgcGxhY2Vob2xkZXI9IkZ1bGwgTmFtZSI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImlucC11aWQiIGNsYXNzPSJtb2Rlcm4taW5wdXQiIHBsYWNlaG9sZGVyPSJTZWNyZXQgSUQgKGUuZy4gUkFIVUw5OSkiPgoKICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImRpdi1xdWl6LXNlbGVjdCIgY2xhc3M9ImhpZGRlbiI+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNlY3Rpb24tbGFiZWwiPlNFTEVDVCBRVUlaIERBVEUvSUQ8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZHJvcGRvd24td3JhcHBlciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImlucC1xaWQiIGNsYXNzPSJtb2Rlcm4taW5wdXQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5DdXJyZW50IExpdmUgUXVpejwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6IDEwcHg7Ij4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIG9uY2xpY2s9InN0YXJ0QXBwKCkiPkNvbmZpcm0gJiBQcm9jZWVkPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lIiBvbmNsaWNrPSJnb0hvbWUoKSI+QmFjazwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGlkPSJ2aWV3LXF1aXoiIGNsYXNzPSJoaWRkZW4iPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkIiBzdHlsZT0idGV4dC1hbGlnbjogbGVmdDsgcGFkZGluZy1ib3R0b206IDYwcHg7Ij4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDsganVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47IG1hcmdpbi1ib3R0b206MTVweDsgYWxpZ24taXRlbXM6Y2VudGVyOyI+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxM3B4OyBmb250LXdlaWdodDo4MDA7IGNvbG9yOnZhcigtLXByaW1hcnkpOyBiYWNrZ3JvdW5kOiNlMGU3ZmY7IHBhZGRpbmc6NnB4IDEwcHg7IGJvcmRlci1yYWRpdXM6OHB4OyIgaWQ9InEtbnVtIj5RMTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjE0cHg7IGZvbnQtd2VpZ2h0OjcwMDsgY29sb3I6dmFyKC0tdGV4dCk7IGJhY2tncm91bmQ6I2YzZjRmNjsgcGFkZGluZzo2cHggMTBweDsgYm9yZGVyLXJhZGl1czo4cHg7IiBpZD0idGltZXItZGlzcGxheSI+MDA6MDA8L3NwYW4+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGRpdiBpZD0icS10ZXh0IiBzdHlsZT0iZm9udC1zaXplOiAxN3B4OyBmb250LXdlaWdodDogNzAwOyBtYXJnaW4tYm90dG9tOiAyNXB4OyBsaW5lLWhlaWdodDogMS41OyI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJxLW9wdGlvbnMiPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBpZD0icS1leHBsIiBjbGFzcz0iZXhwbGFuYXRpb24iPjwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5hdi1iYXIiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lIGJ0bi1uYXYiIHN0eWxlPSJtYXJnaW46MDsiIG9uY2xpY2s9Im5hdigtMSkiIGlkPSJidG4tcHJldiI+UHJldmlvdXM8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc2tpcCBidG4tbmF2IiBzdHlsZT0ibWFyZ2luOjA7IiBvbmNsaWNrPSJza2lwUXVlc3Rpb24oKSI+U2tpcDwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IGJ0bi1uYXYiIHN0eWxlPSJtYXJnaW46MDsiIG9uY2xpY2s9Im5hdigxKSIgaWQ9ImJ0bi1uZXh0Ij5OZXh0PC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGlkPSJ2aWV3LXJlc3VsdCIgY2xhc3M9ImhpZGRlbiI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJsb2NrLW92ZXJsYXkiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxvY2staWNvbiI+8J+UkjwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxvY2stdGl0bGUiPlJlc3VsdCBMb2NrZWQ8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJsb2NrLXN1YiI+VG8gdmlldyB5b3VyIGZ1bGwgcmVwb3J0IGNhcmQgYW5kIHJhbmssIHBsZWFzZSBqb2luIG91ciBXaGF0c0FwcCBjaGFubmVsLjwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgc3R5bGU9ImJhY2tncm91bmQ6ICMyNUQzNjY7IGNvbG9yOiB3aGl0ZTsgd2lkdGg6IGF1dG87IHBhZGRpbmc6IDEycHggMjRweDsiIG9uY2xpY2s9InVubG9ja1Jlc3VsdCgpIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+8J+SrDwvc3Bhbj4gSm9pbiBXaGF0c0FwcCB0byBVbmxvY2sKICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJhbmstY2lyY2xlIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYW5rLW51bSIgaWQ9InJlcy1yYW5rIj4jLS08L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYW5rLWxhYmVsIj5SYW5rPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmFuay10b3RhbC1waWxsIiBpZD0icmVzLXRvdGFsLXRleHQiPm91dCBvZiAtLSBQYXJ0aWNpcGFudHM8L2Rpdj4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGgyIGlkPSJyZXMtbXNnIj5XZWxsIERvbmUhPC9oMj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtcm93Ij4KICAgICAgICAgICAgICAgICAgICA8c3Bhbj5TY29yZTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdC12YWwiIGlkPSJyZXMtc2NvcmUiPjAvMDwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJkZXRhaWxlZC1zdGF0cyI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1yb3ciPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iY29sb3I6IzEwYjk4MTsiPkNvcnJlY3Q8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzdGF0LXZhbCIgaWQ9InJlcy1jb3JyZWN0Ij4wPC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtcm93Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImNvbG9yOiNlZjQ0NDQ7Ij5Xcm9uZzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InN0YXQtdmFsIiBpZD0icmVzLXdyb25nIj4wPC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iaGVpZ2h0OiAxNXB4OyI+PC9kaXY+CgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1jaGFsbGVuZ2UiIG9uY2xpY2s9ImNoYWxsZW5nZUZyaWVuZCgpIj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjIwcHg7Ij7wn5SlPC9zcGFuPiBDaGFsbGVuZ2UgQSBGcmllbmQKICAgICAgICAgICAgICAgIDwvYnV0dG9uPgoKICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9ImJ0bi1jZXJ0LWVsaXRlIiBjbGFzcz0iYnRuIGNlcnQtYnRuIGVsaXRlIiBvbmNsaWNrPSJkb3dubG9hZENlcnQoJ2VsaXRlJykiPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MjBweDsiPvCfj4Y8L3NwYW4+IERvd25sb2FkIEVsaXRlIENlcnRpZmljYXRlCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9ImJ0bi1jZXJ0LXNpbHZlciIgY2xhc3M9ImJ0biBjZXJ0LWJ0biBzaWx2ZXIiIG9uY2xpY2s9ImRvd25sb2FkQ2VydCgnc2lsdmVyJykiPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MjBweDsiPvCfpYg8L3NwYW4+IERvd25sb2FkIFNpbHZlciBDZXJ0aWZpY2F0ZQogICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJidG4tY2VydC1icm9uemUiIGNsYXNzPSJidG4gY2VydC1idG4gYnJvbnplIiBvbmNsaWNrPSJkb3dubG9hZENlcnQoJ2Jyb256ZScpIj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjIwcHg7Ij7wn6WJPC9zcGFuPiBEb3dubG9hZCBCcm9uemUgQ2VydGlmaWNhdGUKICAgICAgICAgICAgICAgIDwvYnV0dG9uPgoKICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJvcmRlci10b3A6IDFweCBzb2xpZCAjZTVlN2ViOyBtYXJnaW46IDIwcHggMDsiPjwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQtc2VsZWN0Ij4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWxlY3QtY2FyZCIgb25jbGljaz0ib3BlbkxpbmsoJ3dhJykiIHN0eWxlPSJib3JkZXItY29sb3I6IzI1RDM2NjsgY29sb3I6IzI1RDM2NjsgYmFja2dyb3VuZDojZjBmZGY0OyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MjZweDsiPvCfkqw8L3NwYW4+IEpvaW4gV2hhdHNBcHAKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWxlY3QtY2FyZCIgb25jbGljaz0ib3BlbkxpbmsoJ3RnJykiIHN0eWxlPSJib3JkZXItY29sb3I6IzIyOUVEOTsgY29sb3I6IzIyOUVEOTsgYmFja2dyb3VuZDojZjBmOWZmOyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MjZweDsiPuKciO+4jzwvc3Bhbj4gSm9pbiBUZWxlZ3JhbQogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUiIG9uY2xpY2s9IndpbmRvdy5wYXJlbnQuY2xvc2VBcHAoKSI+QmFjayB0byBIb21lPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgIDwvZGl2PgoKPHNjcmlwdD4KICAgIC8vIC0tLSBQQVNURSBZT1VSIEdBUyBERVBMT1lNRU5UIFVSTCBIRVJFIC0tLQogICAgY29uc3QgQVBJX1VSTCA9ICJodHRwczovL3NjcmlwdC5nb29nbGUuY29tL21hY3Jvcy9zL0FLZnljYndOc0t5aVRJVmZrY1d6VFY2aG5VUFhnVWg5ZGRCSTNLUEYtQ3FyZjF0MWhpZEhCOERiMTk1WU8zb0gzakV4Q0ZzSEl3L2V4ZWMiOyAKICAgIAogICAgbGV0IGNvbmZpZyA9IHsgQXBwX1RpdGxlOiAiRXhhbSBSZXNjdWUiLCBUaW1lcl9EdXJhdGlvbjogMTgwMCB9OwogICAgbGV0IHN0YXRlID0geyBtb2RlOiAncXVpeicsIHF1ZXN0aW9uczogW10sIGFuc3dlcnM6IFtdLCBpZHg6IDAsIHRpbWVMZWZ0OiAwLCB1c2VyOiB7fSwgcXVpeklEOiAnJyB9OwogICAgbGV0IGFkbWluQWxlcnRDYWxsYmFjayA9IG51bGw7CgogICAgd2luZG93Lm9ubG9hZCA9IGFzeW5jICgpID0+IHsKICAgICAgICBpZihsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZXJfbmFtZScpKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wLW5hbWUnKS52YWx1ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdlcl9uYW1lJyk7CiAgICAgICAgaWYobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2VyX3VpZCcpKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wLXVpZCcpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2VyX3VpZCcpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaEFQSSh7IGFjdGlvbjogJ2dldEluaXQnIH0pOwogICAgICAgICAgICBpZihyZXMuc3RhdHVzID09PSAnc3VjY2VzcycpIHsKICAgICAgICAgICAgICAgIGNvbmZpZyA9IHsgLi4uY29uZmlnLCAuLi5yZXMuY29uZmlnIH07CiAgICAgICAgICAgICAgICBhcHBseUNvbmZpZygpOwogICAgICAgICAgICAgICAgaWYocmVzLnF1aXpMaXN0KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucC1xaWQnKTsKICAgICAgICAgICAgICAgICAgICByZXMucXVpekxpc3QuZm9yRWFjaChxID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wdC52YWx1ZSA9IHE7IG9wdC5pbm5lclRleHQgPSBxOwogICAgICAgICAgICAgICAgICAgICAgICBzZWwuYXBwZW5kQ2hpbGQob3B0KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2goZSkgeyBjb25zb2xlLmVycm9yKGUpOyB9CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRlcicpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgfTsKCiAgICBmdW5jdGlvbiBhcHBseUNvbmZpZygpIHsKICAgICAgICBkb2N1bWVudC50aXRsZSA9IGNvbmZpZy5BcHBfVGl0bGU7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcC10aXRsZScpLmlubmVyVGV4dCA9IGNvbmZpZy5RdWl6X05hbWUgfHwgY29uZmlnLkFwcF9UaXRsZTsKICAgICAgICBpZihjb25maWcuTG9nb19VUkwpIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ28taW1nJykuc3JjID0gY29uZmlnLkxvZ29fVVJMOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nby1pbWcnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dBZG1pbkFsZXJ0KG1zZywgY2FsbGJhY2spIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VzdG9tLWFsZXJ0LW1zZycpLmlubmVySFRNTCA9IG1zZzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VzdG9tLWFsZXJ0LW92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgIGFkbWluQWxlcnRDYWxsYmFjayA9IGNhbGxiYWNrOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsb3NlQ3VzdG9tQWxlcnQoKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbS1hbGVydC1vdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBpZihhZG1pbkFsZXJ0Q2FsbGJhY2spIHsgY29uc3QgY2IgPSBhZG1pbkFsZXJ0Q2FsbGJhY2s7IGFkbWluQWxlcnRDYWxsYmFjayA9IG51bGw7IGNiKCk7IH0KICAgIH0KCiAgICAvLyAtLS0gTkFWSUdBVElPTiBMT0dJQyAtLS0KICAgIGxldCBzZWxlY3RlZENsYXNzID0gJycsIHNlbGVjdGVkU3RyZWFtID0gJycsIHNlbGVjdGVkTWVkaXVtID0gJyc7CgogICAgZnVuY3Rpb24gc2VsZWN0Q2xhc3MoZWwsIGNscykgewogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyN2aWV3LWhvbWUgLnNlbGVjdC1jYXJkJykuZm9yRWFjaChjID0+IGMuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgIHNlbGVjdGVkQ2xhc3MgPSBjbHM7CiAgICAgICAgCiAgICAgICAgY29uc3Qgc0dyaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RyZWFtLWdyaWQnKTsKICAgICAgICBzR3JpZC5pbm5lckhUTUwgPSAnJzsKICAgICAgICBsZXQgc3RyZWFtcyA9IFtdOwogICAgICAgIAogICAgICAgIGlmKGNscyA9PT0gJzEwJykgc3RyZWFtcyA9IFsnQm9hcmRzJ107CiAgICAgICAgZWxzZSBpZihbJzExJywnMTInXS5pbmNsdWRlcyhjbHMpKSBzdHJlYW1zID0gWydCb2FyZHMvUENNJywgJ0JvYXJkcy9QQ0InLCAnTkVFVCcsICdKRUUnXTsKICAgICAgICBlbHNlIGlmKGNscyA9PT0gJ0Z1bGwvRHJvcHBlcicpIHN0cmVhbXMgPSBbJ05FRVQnLCAnSkVFJ107CgogICAgICAgIGlmKHN0cmVhbXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBzdHJlYW1zLmZvckVhY2gocyA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIGRpdi5jbGFzc05hbWUgPSAnc2VsZWN0LWNhcmQnOwogICAgICAgICAgICAgICAgaWYocy5pbmNsdWRlcygnQm9hcmRzJykpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdHJlYW0tZ3JpZCcpLmNsYXNzTGlzdC5hZGQoJ3N0cmVhbXMnKTsgCiAgICAgICAgICAgICAgICBlbHNlIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdHJlYW0tZ3JpZCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3N0cmVhbXMnKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9IHM7CiAgICAgICAgICAgICAgICBkaXYub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjc3RyZWFtLWdyaWQgLnNlbGVjdC1jYXJkJykuZm9yRWFjaCh4ID0+IHguY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFN0cmVhbSA9IHM7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpdi1tZWRpdW0nKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsgCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgc0dyaWQuYXBwZW5kQ2hpbGQoZGl2KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXYtc3RyZWFtJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXYtbWVkaXVtJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7IAogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzZWxlY3RNZWRpdW0oZWwsIG1lZCkgewogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNkaXYtbWVkaXVtIC5zZWxlY3QtY2FyZCcpLmZvckVhY2goYyA9PiBjLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICBzZWxlY3RlZE1lZGl1bSA9IG1lZDsKICAgIH0KCiAgICBmdW5jdGlvbiBwcm9jZWVkVG9EZXRhaWxzKG1vZGUpIHsKICAgICAgICBzdGF0ZS5tb2RlID0gbW9kZTsKICAgICAgICBpZihtb2RlID09PSAncXVpeicpIHsKICAgICAgICAgICAgaWYoIXNlbGVjdGVkQ2xhc3MgfHwgIXNlbGVjdGVkU3RyZWFtIHx8ICFzZWxlY3RlZE1lZGl1bSkgcmV0dXJuIGFsZXJ0KCJQbGVhc2Ugc2VsZWN0IENhdGVnb3J5LCBTdHJlYW0gJiBNZWRpdW0iKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbHMtaGVhZGVyJykuaW5uZXJUZXh0ID0gIlN0YXJ0IFF1aXoiOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGl2LXF1aXotc2VsZWN0JykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbHMtaGVhZGVyJykuaW5uZXJUZXh0ID0gIkNoZWNrIFJlc3VsdCI7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXYtcXVpei1zZWxlY3QnKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKICAgICAgICB9CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctaG9tZScpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3LWRldGFpbHMnKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnb0hvbWUoKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctZGV0YWlscycpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3LWhvbWUnKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBzdGFydEFwcCgpIHsKICAgICAgICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucC1uYW1lJykudmFsdWUudHJpbSgpOwogICAgICAgIGNvbnN0IHVpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnAtdWlkJykudmFsdWUudHJpbSgpOwogICAgICAgIGNvbnN0IHFpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnAtcWlkJykudmFsdWU7CiAgICAgICAgCiAgICAgICAgLy8gLS0tIFFVSVogSUQgU0VMRUNUSU9OIExPR0lDIC0tLQogICAgICAgIC8vIElmIGNoZWNraW5nIHJhbmssIHVzZSBkcm9wZG93biB2YWx1ZSBPUiBjb25maWcgdmFsdWUuCiAgICAgICAgLy8gSWYgc3RhcnRpbmcgcXVpeiwgQUxXQVlTIHVzZSBjb25maWcgdmFsdWUuCiAgICAgICAgaWYoc3RhdGUubW9kZSA9PT0gJ3F1aXonKSB7CiAgICAgICAgICAgICBzdGF0ZS5xdWl6SUQgPSBjb25maWcuQ3VycmVudF9RdWl6X0lEIHx8ICdERU1PJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgc3RhdGUucXVpeklEID0gcWlkIHx8IGNvbmZpZy5DdXJyZW50X1F1aXpfSUQgfHwgJ0RFTU8nOwogICAgICAgIH0KCiAgICAgICAgaWYoIW5hbWUgfHwgIXVpZCkgcmV0dXJuIGFsZXJ0KCJOYW1lIGFuZCBTZWNyZXQgSUQgYXJlIHJlcXVpcmVkIik7CgogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdlcl9uYW1lJywgbmFtZSk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2VyX3VpZCcsIHVpZCk7CiAgICAgICAgc3RhdGUudXNlciA9IHsgbmFtZSwgdWlkLCBjbHM6IHNlbGVjdGVkQ2xhc3MsIHN0cmVhbTogc2VsZWN0ZWRTdHJlYW0sIG1lZGl1bTogc2VsZWN0ZWRNZWRpdW0gfTsKCiAgICAgICAgc2hvd0xvYWRlcigiQ29ubmVjdGluZy4uLiIpOwoKICAgICAgICBpZihzdGF0ZS5tb2RlID09PSAncXVpeicpIHsKICAgICAgICAgICAgY29uc3QgY2hlY2sgPSBhd2FpdCBmZXRjaEFQSSh7IGFjdGlvbjogJ2NoZWNrJywgdXNlcm5hbWU6IHVpZCB9KTsKCiAgICAgICAgICAgIGlmKGNoZWNrLmlzQ2xvc2VkKSB7IGhpZGVMb2FkZXIoKTsgc2hvd0FkbWluQWxlcnQoY2hlY2subWVzc2FnZSB8fCAiU3lzdGVtIENsb3NlZC4iLCAoKSA9PiB7fSk7IHJldHVybjsgfQogICAgICAgICAgICBpZihjaGVjay5zdGF0dXMgPT09ICd0YWtlbicpIHsgaGlkZUxvYWRlcigpOyBzaG93QWRtaW5BbGVydCgi4pqg77iPIFlvdSBoYXZlIGFscmVhZHkgdGFrZW4gdGhpcyBxdWl6IHdpdGggdGhpcyBJRC4iLCAoKSA9PiB7fSk7IHJldHVybjsgfQoKICAgICAgICAgICAgLy8gLS0tIFNUUklDVCBERVZJQ0UgTE9DSyAoTU9WRUQgQUZURVIgU0VSVkVSIFJFU1BPTlNFKSAtLS0KICAgICAgICAgICAgY29uc3QgbGl2ZUlEID0gY2hlY2sucXVpeklEIHx8IHN0YXRlLnF1aXpJRDsKICAgICAgICAgICAgY29uc3QgYXR0ZW1wdEtleSA9IGAke2xpdmVJRH1fJHtzZWxlY3RlZFN0cmVhbX1gOyAKICAgICAgICAgICAgY29uc3QgYXR0ZW1wdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdlcl9hdHRlbXB0cycpIHx8ICd7fScpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGF0dGVtcHRzW2F0dGVtcHRLZXldKSB7CiAgICAgICAgICAgICAgICBoaWRlTG9hZGVyKCk7CiAgICAgICAgICAgICAgICBzaG93QWRtaW5BbGVydCgi8J+aqyBZb3UgaGF2ZSBhbHJlYWR5IGF0dGVtcHRlZCB0aGlzIFF1aXouXG5cblBsZWFzZSBqb2luIG91ciBUZWxlZ3JhbS9XaGF0c0FwcCBjaGFubmVsIGZvciB0aGUgbmV4dCBxdWl6IHVwZGF0ZS4iLCAoKSA9PiB7fSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAgICAgICAgIGNvbnN0IHFSZXMgPSBhd2FpdCBmZXRjaEFQSSh7IAogICAgICAgICAgICAgICAgYWN0aW9uOiAnZ2V0UXVlc3Rpb25zJywgY2xhc3NTZWxlY3Q6IHNlbGVjdGVkQ2xhc3MsIHN0cmVhbVNlbGVjdDogc2VsZWN0ZWRTdHJlYW0sIG1lZGl1bTogc2VsZWN0ZWRNZWRpdW0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZihxUmVzLnF1ZXN0aW9ucyAmJiBxUmVzLnF1ZXN0aW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBzdGF0ZS5xdWVzdGlvbnMgPSBxUmVzLnF1ZXN0aW9uczsKICAgICAgICAgICAgICAgIGlmKGNoZWNrLnF1aXpJRCkgc3RhdGUucXVpeklEID0gY2hlY2sucXVpeklEOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzdGF0ZS5hbnN3ZXJzID0gbmV3IEFycmF5KHN0YXRlLnF1ZXN0aW9ucy5sZW5ndGgpLmZpbGwobnVsbCk7CiAgICAgICAgICAgICAgICBzdGF0ZS50aW1lTGVmdCA9IHBhcnNlSW50KGNvbmZpZy5UaW1lcl9EdXJhdGlvbiB8fCAxODAwKTsKICAgICAgICAgICAgICAgIGhpZGVMb2FkZXIoKTsKICAgICAgICAgICAgICAgIGlmKGNoZWNrLmdsb2JhbEFsZXJ0KSBzaG93QWRtaW5BbGVydChjaGVjay5nbG9iYWxBbGVydCwgKCkgPT4gc3RhcnRRdWl6VUkoKSk7IGVsc2Ugc3RhcnRRdWl6VUkoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGhpZGVMb2FkZXIoKTsgc2hvd0FkbWluQWxlcnQoIk5vIHF1ZXN0aW9ucyBmb3VuZCBhdmFpbGFibGUuIiwgKCkgPT4ge30pOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoQVBJKHsgYWN0aW9uOiAnY2hlY2tSYW5rJywgdXNlcm5hbWU6IHVpZCwgY3VzdG9tUXVpeklEOiBxaWQgfSk7CiAgICAgICAgICAgIGhpZGVMb2FkZXIoKTsKICAgICAgICAgICAgaWYocmVzLnN0YXR1cyA9PT0gJ25vdF9mb3VuZCcpIHsKICAgICAgICAgICAgICAgIHNob3dBZG1pbkFsZXJ0KCJSZXN1bHQgbm90IGZvdW5kIGluIGRhdGFiYXNlLiIsICgpID0+IHt9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICBpZihyZXMuZ2xvYmFsQWxlcnQpIHNob3dBZG1pbkFsZXJ0KHJlcy5nbG9iYWxBbGVydCwgKCkgPT4gc2hvd1Jlc3VsdFVJKHJlcywgdHJ1ZSkpOwogICAgICAgICAgICAgICAgIGVsc2Ugc2hvd1Jlc3VsdFVJKHJlcywgdHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc3RhcnRRdWl6VUkoKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctZGV0YWlscycpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3LXF1aXonKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKICAgICAgICByZW5kZXJRdWVzdGlvbigpOwogICAgICAgIHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgc3RhdGUudGltZUxlZnQtLTsKICAgICAgICAgICAgbGV0IG0gPSBNYXRoLmZsb29yKHN0YXRlLnRpbWVMZWZ0LzYwKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsJzAnKTsKICAgICAgICAgICAgbGV0IHMgPSAoc3RhdGUudGltZUxlZnQlNjApLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwnMCcpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZXItZGlzcGxheScpLmlubmVyVGV4dCA9IGAke219OiR7c31gOwogICAgICAgICAgICBpZihzdGF0ZS50aW1lTGVmdCA8PSAwKSBzdWJtaXRRdWl6KCk7CiAgICAgICAgfSwgMTAwMCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVuZGVyUXVlc3Rpb24oKSB7CiAgICAgICAgY29uc3QgcSA9IHN0YXRlLnF1ZXN0aW9uc1tzdGF0ZS5pZHhdOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxLW51bScpLmlubmVyVGV4dCA9IGBRJHtzdGF0ZS5pZHgrMX0vJHtzdGF0ZS5xdWVzdGlvbnMubGVuZ3RofWA7CiAgICAgICAgY29uc3QgdGFnSFRNTCA9IHEudGFnID8gYDxzcGFuIGNsYXNzPSdleGFtLXRhZyc+JHtxLnRhZ308L3NwYW4+PGJyPmAgOiAnJzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncS10ZXh0JykuaW5uZXJIVE1MID0gdGFnSFRNTCArIHEucTsKICAgICAgICAKICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncS1vcHRpb25zJyk7CiAgICAgICAgZGl2LmlubmVySFRNTCA9ICcnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxLWV4cGwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGNvbnN0IGlzQW5zID0gc3RhdGUuYW5zd2Vyc1tzdGF0ZS5pZHhdICE9PSBudWxsOwoKICAgICAgICBxLm8uZm9yRWFjaCgob3B0LCBpKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBidG4uY2xhc3NOYW1lID0gJ29wdGlvbi1ib3gnOwogICAgICAgICAgICBidG4uaW5uZXJIVE1MID0gYDxzcGFuIHN0eWxlPSJtYXJnaW4tcmlnaHQ6MTBweDsgZm9udC13ZWlnaHQ6ODAwOyI+JHtTdHJpbmcuZnJvbUNoYXJDb2RlKDY1K2kpfS48L3NwYW4+ICR7b3B0fWA7CiAgICAgICAgICAgIGlmKGlzQW5zKSB7CiAgICAgICAgICAgICAgICBidG4uc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsKICAgICAgICAgICAgICAgIGlmKGkgPT09IHEuYykgYnRuLmNsYXNzTGlzdC5hZGQoJ2NvcnJlY3QnKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYoaSA9PT0gc3RhdGUuYW5zd2Vyc1tzdGF0ZS5pZHhdKSBidG4uY2xhc3NMaXN0LmFkZCgnd3JvbmcnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidG4ub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgICAgIGlmKHN0YXRlLmFuc3dlcnNbc3RhdGUuaWR4XSAhPT0gbnVsbCkgcmV0dXJuOwogICAgICAgICAgICAgICAgc3RhdGUuYW5zd2Vyc1tzdGF0ZS5pZHhdID0gaTsKICAgICAgICAgICAgICAgIHJlbmRlclF1ZXN0aW9uKCk7IAogICAgICAgICAgICB9OwogICAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoYnRuKTsKICAgICAgICB9KTsKCiAgICAgICAgaWYoaXNBbnMpIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3EtZXhwbCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncS1leHBsJykuaW5uZXJIVE1MID0gYDxiPvCfkqEgRVhQTEFOQVRJT046PC9iPjxicj4ke3EuZSB8fCAnTkEnfWA7CiAgICAgICAgICAgIGlmKHdpbmRvdy5NYXRoSmF4KSBNYXRoSmF4LnR5cGVzZXRQcm9taXNlKFtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncS1leHBsJyldKS5jYXRjaCgoKT0+e30pOwogICAgICAgIH0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXByZXYnKS5kaXNhYmxlZCA9IHN0YXRlLmlkeCA9PT0gMDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLW5leHQnKS5pbm5lclRleHQgPSAoc3RhdGUuaWR4ID09PSBzdGF0ZS5xdWVzdGlvbnMubGVuZ3RoIC0gMSkgPyAiU3VibWl0IFF1aXoiIDogIk5leHQiOwogICAgICAgIGlmKHdpbmRvdy5NYXRoSmF4KSBNYXRoSmF4LnR5cGVzZXRQcm9taXNlKFtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncS10ZXh0JyksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxLW9wdGlvbnMnKV0pLmNhdGNoKCgpPT57fSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2tpcFF1ZXN0aW9uKCkgeyBuYXYoMSk7IH0KICAgIGZ1bmN0aW9uIG5hdihkaXIpIHsKICAgICAgICBpZihkaXIgPT09IDEgJiYgc3RhdGUuaWR4ID09PSBzdGF0ZS5xdWVzdGlvbnMubGVuZ3RoIC0gMSkgeyBpZihjb25maXJtKCJTdWJtaXQgUXVpej8iKSkgc3VibWl0UXVpeigpOyB9IAogICAgICAgIGVsc2UgeyBzdGF0ZS5pZHggKz0gZGlyOyByZW5kZXJRdWVzdGlvbigpOyB9CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gc3VibWl0UXVpeigpIHsKICAgICAgICBzaG93TG9hZGVyKCJTdWJtaXR0aW5nLi4uIik7CiAgICAgICAgbGV0IHNjb3JlID0gMCwgY29ycmVjdCA9IDAsIHdyb25nID0gMDsKICAgICAgICBzdGF0ZS5xdWVzdGlvbnMuZm9yRWFjaCgocSwgaSkgPT4gewogICAgICAgICAgICBpZihzdGF0ZS5hbnN3ZXJzW2ldID09PSBxLmMpIHsgc2NvcmUgKz0gNDsgY29ycmVjdCsrOyB9CiAgICAgICAgICAgIGVsc2UgaWYoc3RhdGUuYW5zd2Vyc1tpXSAhPT0gbnVsbCkgeyBzY29yZSAtPSAxOyB3cm9uZysrOyB9CiAgICAgICAgfSk7CgogICAgICAgIC8vIC0tLSBTQVZFIEFUVEVNUFQgVE8gREVWSUNFIC0tLQogICAgICAgIGNvbnN0IGF0dGVtcHRzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZXJfYXR0ZW1wdHMnKSB8fCAne30nKTsKICAgICAgICBjb25zdCBhdHRlbXB0S2V5ID0gYCR7c3RhdGUucXVpeklEfV8ke3N0YXRlLnVzZXIuc3RyZWFtfWA7CiAgICAgICAgYXR0ZW1wdHNbYXR0ZW1wdEtleV0gPSB0cnVlOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdlcl9hdHRlbXB0cycsIEpTT04uc3RyaW5naWZ5KGF0dGVtcHRzKSk7CiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoQVBJKHsKICAgICAgICAgICAgYWN0aW9uOiAnc3VibWl0JywgbmFtZTogc3RhdGUudXNlci5uYW1lLCB1c2VybmFtZTogc3RhdGUudXNlci51aWQsCiAgICAgICAgICAgIGNsYXNzTnVtOiBzdGF0ZS51c2VyLmNscywgc3RyZWFtOiBzdGF0ZS51c2VyLnN0cmVhbSwgbWVkaXVtOiBzdGF0ZS51c2VyLm1lZGl1bSwKICAgICAgICAgICAgc2NvcmU6IHNjb3JlLCB0aW1lOiAoY29uZmlnLlRpbWVyX0R1cmF0aW9uIC0gc3RhdGUudGltZUxlZnQpLCByZWNvcmRlZEF0OiBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCkKICAgICAgICB9KTsKCiAgICAgICAgcmVzLmNvcnJlY3QgPSBjb3JyZWN0OyByZXMud3JvbmcgPSB3cm9uZzsKICAgICAgICBoaWRlTG9hZGVyKCk7CiAgICAgICAgc2hvd1Jlc3VsdFVJKHJlcywgZmFsc2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dSZXN1bHRVSShkYXRhLCBpc09sZCkgewogICAgICAgIFsndmlldy1ob21lJywndmlldy1kZXRhaWxzJywndmlldy1xdWl6J10uZm9yRWFjaChpZCA9PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJykpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3LXJlc3VsdCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzLXJhbmsnKS5pbm5lclRleHQgPSBgIyR7ZGF0YS5yYW5rfWA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlcy1zY29yZScpLmlubmVyVGV4dCA9IGRhdGEuc2NvcmU7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlcy10b3RhbC10ZXh0JykuaW5uZXJUZXh0ID0gYG91dCBvZiAke2RhdGEudG90YWwgfHwgJz8nfSBQYXJ0aWNpcGFudHNgOwoKICAgICAgICBpZihpc09sZCkgewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9jay1vdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkLXN0YXRzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9jay1vdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkLXN0YXRzJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXMtY29ycmVjdCcpLmlubmVyVGV4dCA9IGRhdGEuY29ycmVjdDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlcy13cm9uZycpLmlubmVyVGV4dCA9IGRhdGEud3Jvbmc7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByYW5rID0gcGFyc2VJbnQoZGF0YS5yYW5rKTsKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VydC1idG4nKS5mb3JFYWNoKGIgPT4gYi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnKTsKICAgICAgICBpZihyYW5rIDw9IDEwKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLWNlcnQtZWxpdGUnKS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgIGVsc2UgaWYocmFuayA8PSA1MCkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1jZXJ0LXNpbHZlcicpLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgZWxzZSBpZihyYW5rIDw9IDEwMCkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1jZXJ0LWJyb256ZScpLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgCiAgICAgICAgY29uZmV0dGkoeyBwYXJ0aWNsZUNvdW50OiAxNTAsIHNwcmVhZDogNzAsIG9yaWdpbjogeyB5OiAwLjYgfSB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiB1bmxvY2tSZXN1bHQoKSB7CiAgICAgICAgd2luZG93Lm9wZW4oY29uZmlnLldoYXRzQXBwX1VSTCwgJ19ibGFuaycpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2NrLW92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYWxsZW5nZUZyaWVuZCgpIHsKICAgICAgICBjb25zdCBzY29yZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXMtc2NvcmUnKS5pbm5lclRleHQ7CiAgICAgICAgY29uc3QgbGluayA9ICJodHRwczovL2V4YW0tcmVzY3VlLmdpdGh1Yi5pby9FeGFtLXJlc2N1ZS1xdWl6LyI7CiAgICAgICAgY29uc3QgbXNnID0gYPCflKUgSSBqdXN0IHNjb3JlZCAke3Njb3JlfSBpbiB0aGUgRXhhbSBSZXNjdWUgUXVpeiEgXG5cbkNhbiB5b3UgYmVhdCBteSByYW5rPyDwn4+GXG5cbkF0dGVtcHQgbm93OiAke2xpbmt9YDsKICAgICAgICB3aW5kb3cub3BlbihgaHR0cHM6Ly93YS5tZS8/dGV4dD0ke2VuY29kZVVSSUNvbXBvbmVudChtc2cpfWAsICdfYmxhbmsnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkb3dubG9hZENlcnQodHlwZSkgewogICAgICAgIGNvbnN0IHsganNQREYgfSA9IHdpbmRvdy5qc3BkZjsKICAgICAgICBjb25zdCBkb2MgPSBuZXcganNQREYoJ2wnLCAnbW0nLCAnYTQnKTsKICAgICAgICBjb25zdCB3ID0gZG9jLmludGVybmFsLnBhZ2VTaXplLmdldFdpZHRoKCk7IGNvbnN0IGggPSBkb2MuaW50ZXJuYWwucGFnZVNpemUuZ2V0SGVpZ2h0KCk7CiAgICAgICAgCiAgICAgICAgbGV0IGFjY2VudCA9ICcjZjU5ZTBiJzsgLy8gR29sZAogICAgICAgIGxldCB0aXRsZUxpbmUxID0gIkNFUlRJRklDQVRFIE9GIjsgbGV0IHRpdGxlTGluZTIgPSAiQUNISUVWRU1FTlQiOwogICAgICAgIGlmKHR5cGUgPT09ICdzaWx2ZXInKSBhY2NlbnQgPSAnIzY0NzQ4Yic7IGlmKHR5cGUgPT09ICdicm9uemUnKSBhY2NlbnQgPSAnIzc4MzUwZic7CgogICAgICAgIGRvYy5zZXRGaWxsQ29sb3IoMjU1LCAyNTUsIDI1NSk7IGRvYy5yZWN0KDAsIDAsIHcsIGgsICdGJyk7CiAgICAgICAgZG9jLnNldExpbmVXaWR0aCgzKTsgZG9jLnNldERyYXdDb2xvcihhY2NlbnQpOyBkb2MucmVjdCgxMCwgMTAsIHctMjAsIGgtMjApOwogICAgICAgIGRvYy5zZXRMaW5lV2lkdGgoMSk7IGRvYy5yZWN0KDEzLCAxMywgdy0yNiwgaC0yNik7CgogICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiYm9sZCIpOyBkb2Muc2V0VGV4dENvbG9yKGFjY2VudCk7IGRvYy5zZXRGb250U2l6ZSgyNik7CiAgICAgICAgZG9jLnRleHQodGl0bGVMaW5lMSwgdy8yLCAzNSwgeyBhbGlnbjogImNlbnRlciIgfSk7CiAgICAgICAgZG9jLnNldEZvbnRTaXplKDM2KTsgZG9jLnRleHQodGl0bGVMaW5lMiwgdy8yLCA0OCwgeyBhbGlnbjogImNlbnRlciIgfSk7CiAgICAgICAgCiAgICAgICAgZG9jLnNldFRleHRDb2xvcig4MCwgODAsIDgwKTsgZG9jLnNldEZvbnRTaXplKDE0KTsgZG9jLnNldEZvbnQoImhlbHZldGljYSIsICJub3JtYWwiKTsgCiAgICAgICAgCiAgICAgICAgbGV0IGNhdCA9IHN0YXRlLnVzZXIuY2xzIHx8ICJTdHVkZW50IjsgaWYoY2F0ID09PSAnRnVsbC9Ecm9wcGVyJykgY2F0ID0gJ0Ryb3BwZXJzJzsKICAgICAgICBsZXQgc3RyZWFtID0gc3RhdGUudXNlci5zdHJlYW0gfHwgIiI7CiAgICAgICAgY29uc3QgcXVpek5hbWUgPSBjb25maWcuUXVpel9OYW1lIHx8ICJOYXRpb25hbCBPcGVuIFF1aXoiOwogICAgICAgIAogICAgICAgIGRvYy50ZXh0KGBUaGlzIGlzIHRvIGNlcnRpZnkgdGhhdCB0aGUgY2FuZGlkYXRlIGhhcyBzdWNjZXNzZnVsbHkgcGFydGljaXBhdGVkIGluIHRoZWAsIHcvMiwgNjUsIHsgYWxpZ246ICJjZW50ZXIiIH0pOwogICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiYm9sZCIpOyBkb2Muc2V0VGV4dENvbG9yKDAsMCwwKTsKICAgICAgICBkb2MudGV4dChgJHtxdWl6TmFtZX0gZm9yICR7Y2F0fSAoJHtzdHJlYW19KWAsIHcvMiwgNzIsIHsgYWxpZ246ICJjZW50ZXIiIH0pOwogICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAibm9ybWFsIik7IGRvYy5zZXRUZXh0Q29sb3IoODAsODAsODApOwogICAgICAgIGRvYy50ZXh0KGBEZW1vbnN0cmF0aW5nIG91dHN0YW5kaW5nIHBlcmZvcm1hbmNlIGFuZCBjb21wZXRpdGl2ZSBzcGlyaXQuYCwgdy8yLCA3OSwgeyBhbGlnbjogImNlbnRlciIgfSk7CgogICAgICAgIGRvYy5zZXRGb250KCJ0aW1lcyIsICJib2xkaXRhbGljIik7IGRvYy5zZXRUZXh0Q29sb3IoMCwgMCwgMCk7IGRvYy5zZXRGb250U2l6ZSg0MCk7CiAgICAgICAgZG9jLnRleHQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2VyX25hbWUnKSB8fCAiU3R1ZGVudCIsIHcvMiwgMTAwLCB7IGFsaWduOiAiY2VudGVyIiB9KTsKCiAgICAgICAgZG9jLnNldEZvbnQoImhlbHZldGljYSIsICJib2xkIik7IGRvYy5zZXRGb250U2l6ZSgxNik7IGRvYy5zZXRUZXh0Q29sb3IoNjAsIDYwLCA2MCk7CiAgICAgICAgbGV0IHJhbmtUZXh0ID0gYCMke2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXMtcmFuaycpLmlubmVyVGV4dC5yZXBsYWNlKCcjJywnJyl9YDsKICAgICAgICBpZighZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucC1xaWQnKS52YWx1ZSkgcmFua1RleHQgKz0gIiAoUHJvdmlzaW9uYWwpIjsKICAgICAgICAKICAgICAgICBkb2MudGV4dChgUkFOSzogJHtyYW5rVGV4dH0gICAgfCAgICBTQ09SRTogJHtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzLXNjb3JlJykuaW5uZXJUZXh0fWAsIHcvMiwgMTE1LCB7IGFsaWduOiAiY2VudGVyIiB9KTsKCiAgICAgICAgY29uc3QgcXIgPSBuZXcgUVJpb3VzKHsgdmFsdWU6ICJodHRwczovL2V4YW0tcmVzY3VlLmdpdGh1Yi5pby9FeGFtLXJlc2N1ZS1xdWl6LyIsIHNpemU6IDEwMCB9KTsKICAgICAgICBkb2MuYWRkSW1hZ2UocXIudG9EYXRhVVJMKCksICdKUEVHJywgdy8yIC0gMTIsIDEzMCwgMjQsIDI0KTsKCiAgICAgICAgY29uc3QgYnRuWSA9IDE0NTsgY29uc3QgYnRuVyA9IDUwOyBjb25zdCBidG5IID0gMTI7CiAgICAgICAgZG9jLnNldEZpbGxDb2xvcigzNywgMjExLCAxMDIpOyBkb2Mucm91bmRlZFJlY3QoNDAsIGJ0blksIGJ0blcsIGJ0bkgsIDMsIDMsICdGJyk7CiAgICAgICAgZG9jLnNldFRleHRDb2xvcigyNTUsMjU1LDI1NSk7IGRvYy5zZXRGb250U2l6ZSgxMCk7IGRvYy50ZXh0KCJKb2luIFdoYXRzQXBwIiwgNjUsIGJ0blkrOCwge2FsaWduOidjZW50ZXInfSk7CiAgICAgICAgZG9jLmxpbmsoNDAsIGJ0blksIGJ0blcsIGJ0bkgsIHt1cmw6IGNvbmZpZy5XaGF0c0FwcF9VUkx9KTsKCiAgICAgICAgZG9jLnNldEZpbGxDb2xvcigzNCwgMTU4LCAyMTcpOyBkb2Mucm91bmRlZFJlY3Qody05MCwgYnRuWSwgYnRuVywgYnRuSCwgMywgMywgJ0YnKTsKICAgICAgICBkb2MudGV4dCgiSm9pbiBUZWxlZ3JhbSIsIHctNjUsIGJ0blkrOCwge2FsaWduOidjZW50ZXInfSk7CiAgICAgICAgZG9jLmxpbmsody05MCwgYnRuWSwgYnRuVywgYnRuSCwge3VybDogY29uZmlnLlRlbGVncmFtX1VSTH0pOwoKICAgICAgICBkb2Muc2F2ZShgQ2VydGlmaWNhdGVfJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZXJfbmFtZScpfS5wZGZgKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzaG93TG9hZGVyKHR4dCkgeyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGVyLXR4dCcpLmlubmVyVGV4dD10eHQ7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkZXInKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsgfQogICAgZnVuY3Rpb24gaGlkZUxvYWRlcigpIHsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRlcicpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOyB9CiAgICBmdW5jdGlvbiBvcGVuTGluayh0KSB7IHdpbmRvdy5vcGVuKHQ9PT0nd2EnP2NvbmZpZy5XaGF0c0FwcF9VUkw6Y29uZmlnLlRlbGVncmFtX1VSTCwgJ19ibGFuaycpOyB9CiAgICBhc3luYyBmdW5jdGlvbiBmZXRjaEFQSShkYXRhKSB7CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goQVBJX1VSTCwgeyBtZXRob2Q6J1BPU1QnLCBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSB9KTsKICAgICAgICByZXR1cm4gYXdhaXQgcmVzLmpzb24oKTsKICAgIH0KPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=</script>

<script>
    const GAS1_URL = "https://script.google.com/macros/s/AKfycbxh09SoV4uQdbHeVpn8cbU1nJpug8tKWlsalu9QafB6KVCrCUBwh7nVyNdNN6KnNgtPOg/exec";
    const GAS2_URL = "https://script.google.com/macros/s/AKfycbwNsKyiTIVfkcWzTV6hnUPXgUh9ddBI3KPF-Cqrf1t1hidHB8Db195YO3oH3jExCFsHIw/exec";
    const GAS3_URL = "https://script.google.com/macros/s/AKfycbyDZF8TK8f1G_FYRxhMuts9Fr3idOfLcTRZVKvEt3FvMG_9yEeRi4hkjJqMwtJnUHJt/exec";
    
    // --- STATE ---
    let config = {
        title: "Exam Rescue",
        description: "Your ultimate preparation companion.",
        logo: "",
        practice_btn: "Practice Mode",
        quiz_btn: "Live Quiz",
        tg: "#",
        wa: "#",
        testimonials: [],
        css: ""
    };
    
    // GAS Status
    let practiceStatus = 'Active';
    let maintenanceConfig = null;

    // --- FAILSAFE ---
    setTimeout(() => {
        const l = document.getElementById('h-loader');
        if(l && l.style.display !== 'none') {
            // Force hide loader after 8 seconds regardless of state to prevent stuck screen
            l.style.opacity = '0';
            setTimeout(() => l.style.display = 'none', 500);
        }
    }, 8000);

    // --- INIT ---
    window.onload = async () => {
        try {
            const timeoutFetch = (url, body, ms = 5000) => {
                const controller = new AbortController();
                const id = setTimeout(() => controller.abort(), ms);
                return fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    body: JSON.stringify(body),
                    signal: controller.signal
                }).then(r => { clearTimeout(id); return r; }).catch(e => { clearTimeout(id); throw e; });
            };

            // 1. Check GAS1 (Practice Status) - Non-blocking
            try {
                timeoutFetch(GAS1_URL, { action: 'getInit' })
                    .then(r => r.json())
                    .then(json1 => {
                        if (json1 && json1.config) {
                            practiceStatus = json1.config.System_Status || 'Active';
                            maintenanceConfig = json1.config;
                            console.log("Practice Status:", practiceStatus);
                        }
                    })
                    .catch(e => console.warn("GAS1 Check Failed", e));
            } catch (err1) {}

            // 2. Fetch GAS2 Config (Ensure it works)
            try {
                 timeoutFetch(GAS2_URL, { action: 'getInit' })
                    .then(r => r.json())
                    .then(d => console.log("GAS2 Config:", d))
                    .catch(e => console.warn("GAS2 Check Failed", e));
            } catch (e) {}

            // 3. Load Home Config (GAS3)
            try {
                const res = await timeoutFetch(GAS3_URL, { action: 'getHomeData' }, 6000);
                const json = await res.json();
                console.log("Config loaded:", json);

                if(json && json.data) {
                    const d = json.data.config || {};
                    const t = json.data.testimonials || [];

                    config.title = d.Hero_Headline || d.App_Title || config.title;
                    config.description = d.Hero_Subtext || config.description;
                    config.logo = d.Logo_URL || config.logo;
                    config.practice_btn = d.Practice_Btn_Text || config.practice_btn;
                    config.quiz_btn = d.Quiz_Btn_Text || config.quiz_btn;
                    config.tg = d.Telegram_URL || config.tg;
                    config.wa = d.WhatsApp_URL || config.wa;
                    config.css = d.Custom_CSS || "";
                    
                    // Store testimonials with mapping
                    if(t.length > 0) {
                        config.testimonials = t.map(item => ({
                            text: item.msg || "Great app for students!",
                            author: item.name || "Student",
                            image: item.pic || item.image || item.img || `https://api.dicebear.com/7.x/notionists/svg?seed=${item.name || Math.random()}`,
                            rating: item.rating || item.stars || 5
                        }));
                    }
                }
            } catch (e) {
                console.error("Config fetch failed, using defaults", e);
            }

            renderHome();
            
            // Send Visit Stat
            sendStat('visit');
            
            // Start Rotation if we have enough testimonials
            if(config.testimonials && config.testimonials.length > 3) {
                startTestimonialRotator();
            }

            document.getElementById('h-loader').style.opacity = '0';
            setTimeout(() => document.getElementById('h-loader').style.display = 'none', 500);

        } catch (e) {
            console.error("Critical Init Error", e);
            document.getElementById('h-loader').style.display = 'none';
        }
    };

    function showMaintenance(cfg) {
        const view = document.getElementById('maintenance-view');
        const title = document.getElementById('maint-title');
        const desc = document.getElementById('maint-desc');
        const wa = document.getElementById('maint-wa');
        const tg = document.getElementById('maint-tg');

        view.classList.remove('h-hidden');
        
        if (cfg) {
            if (cfg.Maintenance_Msg) desc.innerText = cfg.Maintenance_Msg;
            if (cfg.Telegram_URL) tg.href = cfg.Telegram_URL;
            if (cfg.WhatsApp_URL) wa.href = cfg.WhatsApp_URL;
        }
    }

    function renderHome() {
        if(config.title) document.getElementById('ui-title').innerText = config.title;
        if(config.description) document.getElementById('ui-desc').innerText = config.description;
        if(config.practice_btn) document.getElementById('btn-practice-txt').innerText = config.practice_btn;
        if(config.quiz_btn) document.getElementById('btn-quiz-txt').innerText = config.quiz_btn;
        
        const tgBtn = document.getElementById('ui-tg');
        if(config.tg) tgBtn.href = config.tg;
        tgBtn.onclick = () => sendStat('telegram');

        const waBtn = document.getElementById('ui-wa');
        if(config.wa) waBtn.href = config.wa;
        waBtn.onclick = () => sendStat('whatsapp');
        
        if(config.logo) {
            const l = document.getElementById('ui-logo');
            l.src = config.logo;
            l.classList.remove('h-hidden');
        }
        
        if(config.css) {
            const st = document.createElement('style');
            st.innerHTML = config.css;
            document.head.appendChild(st);
        }

        renderTestimonials();
    }

    // --- TESTIMONIALS LOGIC ---
    let tInterval = null;
    let tQueue = [];

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function createTestimonialCard(t) {
        const div = document.createElement('div');
        div.className = 'h-test-card';
        
        // Stars generation
        const stars = '‚òÖ'.repeat(t.rating) + '‚òÜ'.repeat(5 - t.rating);
        
        div.innerHTML = `
            <img class="h-test-avatar" src="${t.image}" alt="${t.author}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3135/3135715.png'">
            <div class="h-test-content">
                <div class="h-test-header">
                    <span class="h-test-author">${t.author}</span>
                    <span class="h-test-stars">${stars}</span>
                </div>
                <div class="h-test-text">"${t.text}"</div>
            </div>
        `;
        return div;
    }

    function renderTestimonials() {
        const tBox = document.getElementById('ui-testimonials');
        if(!tBox) return;
        tBox.innerHTML = ''; // Clean

        if(!config.testimonials || config.testimonials.length === 0) return;

        // Shuffle initial list
        tQueue = shuffleArray([...config.testimonials]);

        // Create Container
        const container = document.createElement('div');
        container.id = 'h-test-list';
        container.className = 'h-test-container';
        
        // Add initial 3
        const initialCount = Math.min(3, tQueue.length);
        for(let i=0; i<initialCount; i++) {
            const card = createTestimonialCard(tQueue[i]);
            container.appendChild(card);
        }

        tBox.appendChild(container);
    }

    function startTestimonialRotator() {
        if(tInterval) clearInterval(tInterval);
        
        // Index pointer for the NEXT item to show (starts after initial 3)
        let nextIdx = 3; 

        tInterval = setInterval(() => {
            const container = document.getElementById('h-test-list');
            if(!container) return;

            // Get current cards
            const cards = container.getElementsByClassName('h-test-card');
            if(cards.length === 0) return;

            // 1. Fade out top card
            const topCard = cards[0];
            topCard.style.marginTop = '-110px'; // Slide up
            topCard.style.opacity = '0';
            
            // 2. Prepare next data
            if(nextIdx >= tQueue.length) nextIdx = 0; // Loop
            const nextData = tQueue[nextIdx];
            nextIdx++;

            // 3. Create new card (hidden)
            const newCard = createTestimonialCard(nextData);
            newCard.classList.add('h-test-enter');
            container.appendChild(newCard);

            // 4. Cleanup and Animate In
            setTimeout(() => {
                topCard.remove(); // Remove old
                
                // Trigger reflow for animation
                void newCard.offsetWidth;
                
                newCard.classList.remove('h-test-enter'); // Fade in
            }, 500); // Wait for slide up transition

        }, 4000); // 4 seconds
    }

    // --- MODE LAUNCHER ---
    window.closeApp = function() {
        const container = document.getElementById('app-frame-container');
        if(container) {
            container.innerHTML = '';
            container.style.display = 'none';
        }
    };

    window.launchMode = function(modeKey) {
        // Maintenance Check for Practice Mode
        if (modeKey === 'practice') {
            if (practiceStatus === 'Maintenance' || practiceStatus === 'Quiz') {
                showMaintenance(maintenanceConfig);
                return;
            }
        }

        try {
            const dataEl = document.getElementById('data-' + modeKey);
            if(!dataEl) return alert("Mode data not found");
            
            const b64 = dataEl.textContent.trim();
            if(!b64) return alert("Mode content empty");

            const container = document.getElementById('app-frame-container');
            container.innerHTML = ''; // Clean
            container.style.display = 'block';

            const iframe = document.createElement('iframe');
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            
            container.appendChild(iframe);
            
            // Write content
            const doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.open();
            
            // FIXED: Proper UTF-8 Decoding for Emojis
            const b64Clean = b64.replace(/\s/g, '');
            const binaryStr = atob(b64Clean);
            const bytes = new Uint8Array(binaryStr.length);
            for (let i = 0; i < binaryStr.length; i++) {
                bytes[i] = binaryStr.charCodeAt(i);
            }
            let decodedHtml = new TextDecoder("utf-8").decode(bytes);
            
            // INJECT DYNAMIC GAS URL (Ensures apps use the Homepage's Sheet Config)
            const targetURL = modeKey === 'practice' ? GAS1_URL : GAS2_URL;
            // Replaces const API_URL = "..." with the new URL
            decodedHtml = decodedHtml.replace(/const API_URL\s*=\s*["'][^"']+["'];/, `const API_URL = "${targetURL}";`);

            // Safety: Ensure Charset is UTF-8
            const finalHtml = decodedHtml.includes('<meta charset="UTF-8">') 
                ? decodedHtml 
                : decodedHtml.replace('<head>', '<head><meta charset="UTF-8">');

            doc.write(finalHtml);
            doc.close();
            
            // Hint
            const toast = document.getElementById('back-toast');
            toast.style.opacity = '1';
            setTimeout(() => toast.style.opacity = '0', 4000);
        } catch(e) {
            alert("Failed to launch mode: " + e.message);
            location.reload();
        }
    };
</script>
</body>
</html>
